"use client";

import { useState, useMemo, useEffect } from "react";
import { useAppStore } from "@/store/useAppStore";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Input } from "@/components/ui/input";
import { Checkbox } from "@/components/ui/checkbox";
import {
  Eye,
  Save,
  ChevronRight,
  ChevronLeft,
  Check,
  Home,
  Utensils,
  Bed,
  Bath,
  ArrowRight,
  ArrowLeft,
  RefreshCw,
  AlertCircle,
  FileText,
  Upload,
  Clock,
  Database as DatabaseIcon,
  Palette,
  Type,
  Layout,
  Image,
  Video,
  HelpCircle,
  UserCog,
  Search,
  Monitor,
  Tablet,
  Smartphone,
  Download
} from 'lucide-react'

interface PrototypeViewerProps {
  onNavigateToModules: () => void;
}

interface Module {
  id: string;
  name: string;
  hasPreview: boolean;
  category: string;
}

interface Condition {
  id: string;
  label: string;
  type: "toggle" | "radio";
  options?: string[];
  defaultValue: string | boolean;
}

// Sample option data for prototyping
const sampleOptionData = {
  depth1Options: [
    {
      id: "opt1-1",
      name: "í™•ì¥í˜•",
      price: 5000000,
      description: "ê±°ì‹¤ í™•ì¥ + ì¹¨ì‹¤2 í™•ì¥",
      image: "/placeholder.svg",
    },
    {
      id: "opt1-2",
      name: "ê¸°ë³¸í˜•",
      price: 0,
      description: "ê¸°ë³¸ í‰ë©´",
      isDefault: true,
      image: "/placeholder.svg",
    },
    {
      id: "opt1-3",
      name: "ì•ŒíŒŒë£¸í˜•",
      price: 3000000,
      description: "ì•ŒíŒŒë£¸ ì¶”ê°€",
      image: "/placeholder.svg",
    },
  ],
  depth2Options: [
    // ì£¼ë°© ê°€êµ¬
    {
      id: "opt2-1",
      name: "ì£¼ë°© ê°€êµ¬ì¥",
      category: "ì£¼ë°©",
      price: 2000000,
      parent: "opt1-1", // í™•ì¥í˜•ì¼ ë•Œë§Œ
      image: "/placeholder.svg",
    },
    // ëƒ‰ì¥ê³ ì¥ - ê¹€ì¹˜ëƒ‰ì¥ê³ ì¥ê³¼ ë°°íƒ€ì 
    {
      id: "opt2-2",
      name: "ëƒ‰ì¥ê³ ì¥",
      category: "ì£¼ë°©",
      price: 800000,
      excludes: ["opt2-3"], // ë°°íƒ€ì  ì¡°ê±´
      image: "/placeholder.svg",
    },
    {
      id: "opt2-3",
      name: "ê¹€ì¹˜ëƒ‰ì¥ê³ ì¥",
      category: "ì£¼ë°©",
      price: 600000,
      excludes: ["opt2-2"], // ë°°íƒ€ì  ì¡°ê±´
      image: "/placeholder.svg",
    },
    // ì‹œìŠ¤í…œ ì—ì–´ì»¨
    {
      id: "opt2-4",
      name: "ì‹œìŠ¤í…œ ì—ì–´ì»¨ - ê±°ì‹¤+ì¹¨ì‹¤",
      category: "ëƒ‰ë‚œë°©",
      price: 1000000,
      image: "/placeholder.svg",
    },
    {
      id: "opt2-5",
      name: "ì‹œìŠ¤í…œ ì—ì–´ì»¨ - ì „ì²´",
      category: "ëƒ‰ë‚œë°©",
      price: 2000000,
      image: "/placeholder.svg",
    },
    // ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜
    {
      id: "opt2-6",
      name: "ê¸°ë³¸ ì¡°ëª… ì œì™¸",
      category: "ì¡°ëª…",
      price: -500000, // ë§ˆì´ë„ˆìŠ¤ ê°€ê²©
      description: "ê¸°ë³¸ ì¡°ëª…ì„ ì œì™¸í•˜ê³  ê°€ê²© ì°¨ê°",
      image: "/placeholder.svg",
    },
  ],
  depth3Options: [
    {
      id: "opt3-1",
      name: "ì‹ê¸°ì„¸ì²™ê¸°",
      category: "ì£¼ë°©ê°€ì „",
      price: 1500000,
      requires: ["opt2-1"], // ì£¼ë°© ê°€êµ¬ì¥ í•„ìˆ˜
      parent: "opt2-1",
      image: "/placeholder.svg",
    },
    {
      id: "opt3-2",
      name: "ì¸ë•ì…˜ 3êµ¬",
      category: "ì£¼ë°©ê°€ì „",
      price: 800000,
      requires: ["opt2-1"],
      parent: "opt2-1",
      image: "/placeholder.svg",
    },
  ],
};

// M03 Sample Data
const sampleSpaceData = [
  { id: "living", name: "ê±°ì‹¤", icon: Home },
  { id: "kitchen", name: "ì£¼ë°©", icon: Utensils },
  { id: "bedroom1", name: "ì¹¨ì‹¤1", icon: Bed },
  { id: "bedroom2", name: "ì¹¨ì‹¤2", icon: Bed },
  { id: "bathroom", name: "ìš•ì‹¤", icon: Bath },
];

const optionSpaceMapping: Record<string, string> = {
  "ì£¼ë°© ê°€êµ¬ì¥": "kitchen",
  "ì¹¨ì‹¤ ë¶™ë°•ì´ì¥": "bedroom1",
  "ê±°ì‹¤ í™•ì¥": "living",
  "ìš•ì‹¤ íƒ€ì¼": "bathroom",
};

const highlightAreas = [
  { id: "area1", name: "ì£¼ë°© ìƒë¶€ì¥", space: "kitchen", color: "blue" },
  { id: "area2", name: "ê±°ì‹¤ ë²½ë©´", space: "living", color: "green" },
  { id: "area3", name: "ì¹¨ì‹¤ ë¶™ë°•ì´ì¥", space: "bedroom1", color: "orange" },
];

const structureTypes = [
  {
    id: "basic",
    name: "ê¸°ë³¸í˜•",
    model: "model_basic.glb",
    description: "84ã¡ ê¸°ë³¸ êµ¬ì¡°",
  },
  {
    id: "expanded",
    name: "í™•ì¥í˜•",
    model: "model_expanded.glb",
    description: "ê±°ì‹¤+ì¹¨ì‹¤2 í™•ì¥",
  },
  {
    id: "alpharoom",
    name: "ì•ŒíŒŒë£¸í˜•",
    model: "model_alpha.glb",
    description: "ì•ŒíŒŒë£¸ ì¶”ê°€ êµ¬ì¡°",
  },
];

// M04 Sample Data
const selectedOptionsSummary = [
  { category: "1Depth", name: "í™•ì¥í˜•", price: 5000000 },
  { category: "ì£¼ë°©", name: "ì£¼ë°© ê°€êµ¬ì¥", price: 2000000 },
  { category: "ì£¼ë°©", name: "ëƒ‰ì¥ê³ ì¥", price: 800000 },
  { category: "ì¡°ëª…", name: "ê±°ì‹¤ LED ì¡°ëª…", price: 500000 },
];

const optionCategories = [
  { id: 0, name: "íƒ€ì… ì„ íƒ", description: "ê¸°ë³¸í˜•/í™•ì¥í˜•/ì•ŒíŒŒë£¸í˜•" },
  { id: 1, name: "ì£¼ë°© ì˜µì…˜", description: "ì£¼ë°© ê°€êµ¬, ê°€ì „" },
  { id: 2, name: "ì¹¨ì‹¤ ì˜µì…˜", description: "ë¶™ë°•ì´ì¥, ì¡°ëª…" },
  { id: 3, name: "ìš•ì‹¤ ì˜µì…˜", description: "íƒ€ì¼, ìˆ˜ì „" },
  { id: 4, name: "ë§ˆê°ì¬", description: "ë°”ë‹¥ì¬, ë²½ì§€" },
];

// M05 Sample Data
const sampleHistory = [
  {
    id: "QUOTE-001",
    date: "2024-01-15 14:30",
    total: 15800000,
    status: "ì œì¶œì™„ë£Œ",
  },
  {
    id: "QUOTE-002",
    date: "2024-01-16 10:15",
    total: 16200000,
    status: "ì œì¶œì™„ë£Œ",
  },
  {
    id: "QUOTE-003",
    date: "2024-01-17 16:45",
    total: 14900000,
    status: "ì œì¶œì™„ë£Œ",
  },
];

// M06 Sample Data
const themeColors = [
  { id: 'blue', name: 'ë¸”ë£¨', color: '#2563EB' },
  { id: 'green', name: 'ê·¸ë¦°', color: '#16A34A' },
  { id: 'purple', name: 'í¼í”Œ', color: '#9333EA' },
  { id: 'orange', name: 'ì˜¤ë Œì§€', color: '#EA580C' }
]

const fontFamilies = [
  { id: 'sans', name: 'ê¸°ë³¸ ê³ ë”• (Pretendard)', class: 'font-sans' },
  { id: 'serif', name: 'ëª…ì¡°ì²´ (Noto Serif)', class: 'font-serif' },
  { id: 'mono', name: 'ê³ ì •í­ (JetBrains Mono)', class: 'font-mono' }
]

const layoutOptions = [
  { id: 'bottom-fixed', name: 'í•˜ë‹¨ ê³ ì •í˜•', description: 'í™”ë©´ í•˜ë‹¨ì— ë²„íŠ¼ ê³ ì •' },
  { id: 'inline', name: 'ì¸ë¼ì¸í˜•', description: 'ì»¨í…ì¸  íë¦„ì— ë”°ë¼ ë°°ì¹˜' },
  { id: 'floating', name: 'í”Œë¡œíŒ…í˜•', description: 'ìš°ì¸¡ í•˜ë‹¨ì— ë– ìˆëŠ” ë²„íŠ¼' }
]

// M08 Sample Data
const adminData = [
  { id: 1, user: 'ê¹€ì² ìˆ˜', type: '84A', date: '2024-02-05', status: 'ì œì¶œì™„ë£Œ' },
  { id: 2, user: 'ì´ì˜í¬', type: '59B', date: '2024-02-05', status: 'ì„ì‹œì €ì¥' },
  { id: 3, user: 'ë°•ë¯¼ìˆ˜', type: '84B', date: '2024-02-04', status: 'ì œì¶œì™„ë£Œ' },
  { id: 4, user: 'ìµœì§€ì€', type: '101A', date: '2024-02-04', status: 'ì œì¶œì™„ë£Œ' },
  { id: 5, user: 'ì •í˜„ìš°', type: '59A', date: '2024-02-03', status: 'ìƒë‹´ìš”ì²­' }
]

export function PrototypeViewer({ onNavigateToModules }: PrototypeViewerProps) {
  const selectedModulesStore = useAppStore((state) => state.selectedModules);

  // Define all available modules with their categories
  const allModules = useMemo(
    () => ({
      "M01: ì¸ì¦/ì ‘ê·¼ ê´€ë¦¬": [
        { id: "M01-1", name: "ê±´ì„¤ì‚¬ SSO ì—°ë™", hasPreview: false },
        { id: "M01-2", name: "ìì²´ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ", hasPreview: false },
        { id: "M01-3", name: "ê³ ê° ì •ë³´ ì…ë ¥ í¼", hasPreview: true },
        { id: "M01-4", name: "ì…ë ¥ ì •ë³´ ìœ íš¨ì„± ê²€ì¦", hasPreview: true },
        { id: "M01-5", name: "ì •ë³´ ì¬ì…ë ¥ ê¸°ëŠ¥", hasPreview: false },
        { id: "M01-6", name: "ì…ë ¥ ì •ë³´ ìƒë‹¨ í‘œì‹œ", hasPreview: false },
      ],
      "M02: ì˜µì…˜ êµ¬ì¡° ë° ì„ íƒ": [
        { id: "M02-1", name: "1Depth ì˜µì…˜ UI", hasPreview: false },
        { id: "M02-2", name: "2Depth ì˜µì…˜ UI", hasPreview: true },
        { id: "M02-3", name: "3Depth ì˜µì…˜ UI", hasPreview: true },
        { id: "M02-4", name: "1Depth ì—°ë™ ë¡œì§", hasPreview: false },
        { id: "M02-5", name: "ë‹¤ì¤‘ ì„ íƒ ê¸°ëŠ¥", hasPreview: false },
        { id: "M02-6", name: "ì˜µì…˜ ê¸°ë³¸ê°’ ì„¤ì •", hasPreview: false },
        { id: "M02-7", name: "ì˜µì…˜ë³„ ê°€ê²© í‘œì‹œ", hasPreview: false },
        { id: "M02-8", name: "ì‹¤ì‹œê°„ ê¸ˆì•¡ ê³„ì‚°", hasPreview: false },
        { id: "M02-9", name: "ë°°íƒ€ì  ì„ íƒ ë¡œì§", hasPreview: false },
        { id: "M02-10", name: "ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜ UI", hasPreview: false },
        { id: "M02-11", name: "í•„ìˆ˜ ì—°ê´€ ì„ íƒ ê°€ì´ë“œ", hasPreview: false },
      ],
      "M03: ê³µê°„/ë„¤ë¹„ê²Œì´ì…˜": [
        { id: "M03-1", name: "3D ë·°ì–´ ê¸°ë³¸", hasPreview: true },
        { id: "M03-2", name: "ìœ„ì¹˜ ë²„íŠ¼ ë„¤ë¹„ê²Œì´ì…˜", hasPreview: true },
        { id: "M03-3", name: "ì˜µì…˜ ì„ íƒ ì‹œ ìë™ ì´ë™", hasPreview: true },
        { id: "M03-4", name: "ìœ„ì¹˜ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ", hasPreview: true },
        { id: "M03-5", name: "êµ¬ì¡°ë¬¼ ë™ì  êµì²´", hasPreview: true },
      ],
      "M04: ê²¬ì  ê¸°ëŠ¥": [
        { id: "M04-1", name: "ê²¬ì ì„œ íŒì—…", hasPreview: true },
        { id: "M04-2", name: "ì˜µì…˜ ìš”ì•½ í‘œì‹œ", hasPreview: true },
        { id: "M04-3", name: "ìµœì¢… ê²¬ì ì„œ í™”ë©´", hasPreview: true },
        { id: "M04-4", name: "ê²¬ì ì„œ ë‚´ ì˜µì…˜ ìˆ˜ì •", hasPreview: true },
        { id: "M04-5", name: "ë‹¤ìŒ/ì´ì „ ë²„íŠ¼", hasPreview: true },
        { id: "M04-6", name: "PDF ë‹¤ìš´ë¡œë“œ", hasPreview: true },
        { id: "M04-7", name: "Excel ë‹¤ìš´ë¡œë“œ", hasPreview: true },
      ],
      "M05: ë°ì´í„° ì €ì¥/ì „ì†¡": [
        { id: "M05-1", name: "êµ¬ê¸€ ì‹œíŠ¸ API ì—°ë™", hasPreview: true },
        { id: "M05-2", name: "ìì²´ DB ì €ì¥", hasPreview: true },
        { id: "M05-3", name: "ê±´ì„¤ì‚¬ API ì „ì†¡", hasPreview: true },
        { id: "M05-4", name: "NíšŒ ì œì¶œ í—ˆìš©", hasPreview: true },
        { id: "M05-5", name: "1íšŒ ì œì¶œ ì œí•œ", hasPreview: true },
        { id: "M05-6", name: "ì œì¶œ ì´ë ¥ ê´€ë¦¬", hasPreview: true },
        { id: "M05-7", name: "ì œì¶œ í™•ì¸ íŒì—…", hasPreview: true },
      ],
      "M06: UI ì»¤ìŠ¤í„°ë§ˆì´ì§•": [
        { id: "M06-1", name: "ë¡œê³  êµì²´", hasPreview: true },
        { id: "M06-2", name: "ì»¬ëŸ¬ í…Œë§ˆ ì„¤ì •", hasPreview: true },
        { id: "M06-3", name: "í°íŠ¸ ì ìš©", hasPreview: true },
        { id: "M06-4", name: "íƒ€ì… ì •ë³´ í‘œì‹œ", hasPreview: true },
        { id: "M06-5", name: "ë²„íŠ¼ ë ˆì´ì•„ì›ƒ ì„¤ì •", hasPreview: true },
      ],
      "M07: ê°€ì´ë“œ/ë„ì›€ë§": [
        { id: "M07-1", name: "ì´ë¯¸ì§€ ê°€ì´ë“œ ì œì‘", hasPreview: true },
        { id: "M07-2", name: "ì˜ìƒ ê°€ì´ë“œ ì œì‘", hasPreview: true },
        { id: "M07-3", name: "ê°€ì´ë“œ íŒì—…", hasPreview: true },
        { id: "M07-4", name: "ê°€ì´ë“œ ë²„íŠ¼", hasPreview: true },
      ],
      "M08: ê´€ë¦¬ ê¸°ëŠ¥": [
        { id: "M08-1", name: "ê´€ë¦¬ì í˜ì´ì§€", hasPreview: true },
        { id: "M08-2", name: "ë°ì´í„° ê²€ìƒ‰ ê¸°ëŠ¥", hasPreview: true },
        { id: "M08-3", name: "Excel ì¼ê´„ ë‹¤ìš´ë¡œë“œ", hasPreview: true },
      ],
    }),
    []
  );

  // Filter modules based on store selection
  const modulesByCategory = useMemo(() => {
    // If no modules are selected (e.g. initial state), show all to allow exploration
    if (selectedModulesStore.length === 0) {
      return allModules;
    }

    const filtered: Record<string, { id: string; name: string }[]> = {};

    Object.entries(allModules).forEach(([category, modules]) => {
      // Filter modules that are in the selectedModulesStore
      // Note: Some modules in PrototypeViewer might be mockups for modules that
      // have slightly different IDs or concepts in the store.
      // For now, we assume direct ID matching or basic fallback.
      // Since the store IDs (e.g. 'M01-3') match the prototype IDs, we can filter directly.
      const activeModules = modules.filter((m) =>
        selectedModulesStore.includes(m.id)
      );

      if (activeModules.length > 0) {
        filtered[category] = activeModules;
      }
    });

    return filtered;
  }, [allModules, selectedModulesStore]);

  // Get the first available module ID for default selection
  const firstModuleId = useMemo(() => {
    const categories = Object.keys(modulesByCategory);
    // ì´ ë¶€ë¶„ì—ì„œ categories[0] ë’¤ì— íƒ€ì…ì„ ëª…ì‹œí•´ ì¤ë‹ˆë‹¤.
    if (
      categories.length > 0 &&
      modulesByCategory[categories[0] as keyof typeof modulesByCategory]
        .length > 0
    ) {
      return modulesByCategory[
        categories[0] as keyof typeof modulesByCategory
      ][0].id;
    }
    return "M01-3";
  }, [modulesByCategory]);

  const [selectedModule, setSelectedModule] = useState(firstModuleId);

  // Update selected module if the current one is no longer available (e.g. deselected)
  useEffect(() => {
    const isCurrentModuleAvailable = Object.values(modulesByCategory)
      .flat()
      .some((m) => m.id === selectedModule);

    if (!isCurrentModuleAvailable) {
      setSelectedModule(firstModuleId);
    }
  }, [modulesByCategory, selectedModule, firstModuleId]);

  const [expandedCategories, setExpandedCategories] = useState<Set<string>>(
    new Set([
      "M01: ì¸ì¦/ì ‘ê·¼ ê´€ë¦¬",
      "M02: ì˜µì…˜ êµ¬ì¡° ë° ì„ íƒ",
      "M04: ê²¬ì  ê¸°ëŠ¥",
      "M05: ë°ì´í„° ì €ì¥/ì „ì†¡",
    ])
  );
  const [deviceView, setDeviceView] = useState<"desktop" | "tablet" | "mobile">(
    "desktop"
  );
  const [conditions, setConditions] = useState<Record<string, any>>({
    loginRequired: true,
    validationCheck: false,
    reenterMethod: "ìƒˆë¡œê³ ì¹¨",
    validationType: "ì‹¤ì‹œê°„",
    errorDisplay: "ì¸ë¼ì¸",
    depth: "2",
    multiSelect: false,
    depthInfluence: true,
  });

  // Form state for M01-4
  const [formData, setFormData] = useState({
    name: "",
    phone: "",
    type: "",
    unit: "",
  });
  const [formErrors, setFormErrors] = useState<Record<string, string>>({});
  const [showSubmitSuccess, setShowSubmitSuccess] = useState(false);
  const [submitAttempted, setSubmitAttempted] = useState(false);

  // Module selection state for M02-2
  const [selectedPackage, setSelectedPackage] = useState(false);
  const [selectedOptions, setSelectedOptions] = useState<
    Record<string, string>
  >({
    aircon: "",
    door: "",
    closet: "",
  });
  const [showPackageConfirm, setShowPackageConfirm] = useState(false);

  // States for M01-2: ìì²´ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ
  const [loginData, setLoginData] = useState({ id: "", password: "" });
  const [loginError, setLoginError] = useState("");

  const handleLogin = () => {
    if (!loginData.id || !loginData.password) {
      setLoginError("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");
      return;
    }
    setLoginError("");
    // ë¡œê·¸ì¸ ì„±ê³µ ì‹œë®¬ë ˆì´ì…˜
    alert("ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤!");
  };

  // States for M01-5: ì •ë³´ ì¬ì…ë ¥ ê¸°ëŠ¥
  const [isEditing, setIsEditing] = useState(false);
  const [userInfo, setUserInfo] = useState({
    name: "í™ê¸¸ë™",
    phone: "010-1234-5678",
    type: "84A",
    unit: "101ë™ 1001í˜¸",
  });

  // States for M02 Modules
  const [selected1Depth, setSelected1Depth] = useState<string>("opt1-2");
  const [main1Depth, setMain1Depth] = useState<string>("opt1-1");
  const [dependent2Depth, setDependent2Depth] = useState<string[]>([]);
  const [multiSelection, setMultiSelection] = useState<string[]>([]);
  const [currentSelection, setCurrentSelection] = useState<string>(""); // Initialized later in useEffect or useMemo if needed, but simple string is fine
  const [calc1Depth, setCalc1Depth] = useState<string>("opt1-2");
  const [calc2Depth, setCalc2Depth] = useState<string[]>([]);
  const [exclusiveSelection, setExclusiveSelection] = useState<string[]>([]);
  const [minusSelection, setMinusSelection] = useState<string[]>([]);
  const [depSelection, setDepSelection] = useState<string[]>([]);

  // States for M03: ê³µê°„/ë„¤ë¹„ê²Œì´ì…˜
  const [m03_2_currentSpace, setM03_2_currentSpace] = useState("living");
  const [m03_3_selectedOption, setM03_3_selectedOption] = useState("");
  const [m03_3_targetSpace, setM03_3_targetSpace] = useState("");
  const [m03_3_isMoving, setM03_3_isMoving] = useState(false);
  const [m03_4_highlightedAreas, setM03_4_highlightedAreas] = useState<
    string[]
  >([]);
  const [m03_5_structureType, setM03_5_structureType] = useState("basic");

  // States for M04: ê²¬ì  ê¸°ëŠ¥
  const [m04_2_selectedOptions, setM04_2_selectedOptions] = useState<any[]>([]);
  const [m04_4_quoteOptions, setM04_4_quoteOptions] = useState<any[]>(
    selectedOptionsSummary
  );
  const [m04_4_isEditing, setM04_4_isEditing] = useState(false);
  const [m04_5_currentCategory, setM04_5_currentCategory] = useState(0);

  // States for M05: ë°ì´í„° ì €ì¥/ì „ì†¡
  const [m05_2_isSaving, setM05_2_isSaving] = useState(false);
  const [m05_2_saveResult, setM05_2_saveResult] = useState<any>(null);
  const [m05_3_isSending, setM05_3_isSending] = useState(false);
  const [m05_3_sendResult, setM05_3_sendResult] = useState<any>(null);
  const [m05_4_submitCount, setM05_4_submitCount] = useState(0);
  const [m05_4_maxSubmits, setM05_4_maxSubmits] = useState(5);
  const [m05_5_hasSubmitted, setM05_5_hasSubmitted] = useState(false);
  const [m05_5_submittedData, setM05_5_submittedData] = useState<any>(null);
  const [m05_6_history, setM05_6_history] = useState<any[]>(sampleHistory);
  const [m05_7_showConfirm, setM05_7_showConfirm] = useState(false)
  const [m05_7_isSubmitting, setM05_7_isSubmitting] = useState(false)

  // States for M06: UI ì»¤ìŠ¤í„°ë§ˆì´ì§•
  const [m06_1_logo, setM06_1_logo] = useState<string | null>(null)
  const [m06_2_color, setM06_2_color] = useState('blue')
  const [m06_3_font, setM06_3_font] = useState('sans')
  const [m06_4_typePos, setM06_4_typePos] = useState('top')
  const [m06_5_layout, setM06_5_layout] = useState('bottom-fixed')

  // States for M07: ê°€ì´ë“œ/ë„ì›€ë§
  const [m07_1_currentStep, setM07_1_currentStep] = useState(0)
  const [m07_2_selectedVideo, setM07_2_selectedVideo] = useState<any>(null)
  const [m07_3_showPopup, setM07_3_showPopup] = useState(false)
  const [m07_3_currentPage, setM07_3_currentPage] = useState(0)
  const [m07_3_dontShowAgain, setM07_3_dontShowAgain] = useState(false)
  const [m07_4_showGuide, setM07_4_showGuide] = useState(false)
  const [m07_4_selectedGuide, setM07_4_selectedGuide] = useState('')

  // States for M08: ê´€ë¦¬ ê¸°ëŠ¥
  const [m08_1_stats] = useState({
    totalSubmissions: 247,
    todaySubmissions: 15,
    averageAmount: 16500000,
    topOption: 'ì£¼ë°© ê°€êµ¬ì¥'
  })
  const [m08_2_searchTerm, setM08_2_searchTerm] = useState('')
  const [m08_2_filterType, setM08_2_filterType] = useState('all')
  const [m08_2_searchResults, setM08_2_searchResults] = useState<any[]>([])
  const [m08_3_isExporting, setM08_3_isExporting] = useState(false)
  const [m08_3_exportProgress, setM08_3_exportProgress] = useState(0)
  const [m08_3_includeOptions, setM08_3_includeOptions] = useState(true)
  const [m08_3_includeCustomerInfo, setM08_3_includeCustomerInfo] = useState(true)

  // Initialize currentSelection for M02-6
  useEffect(() => {
    const defaultOption = sampleOptionData.depth1Options.find(
      (opt) => opt.isDefault
    );
    if (defaultOption) {
      setCurrentSelection(defaultOption.id);
    }
  }, []);

  const toggleCategory = (category: string) => {
    setExpandedCategories((prev) => {
      const newSet = new Set(prev);
      if (newSet.has(category)) {
        newSet.delete(category);
      } else {
        newSet.add(category);
      }
      return newSet;
    });
  };

  const getConditionsForModule = (moduleId: string): Condition[] => {
    switch (moduleId) {
      case "M01-3":
        return [
          {
            id: "loginRequired",
            label: "ë¡œê·¸ì¸ í•„ìš”",
            type: "toggle",
            defaultValue: true,
          },
          {
            id: "validationCheck",
            label: "ìœ íš¨ì„± ì²´í¬",
            type: "toggle",
            defaultValue: false,
          },
          {
            id: "reenterMethod",
            label: "ì¬ì…ë ¥ ë°©ë²•",
            type: "radio",
            options: ["ìƒˆë¡œê³ ì¹¨", "ìˆ˜ì •ë²„íŠ¼"],
            defaultValue: "ìƒˆë¡œê³ ì¹¨",
          },
        ];
      case "M01-4":
        return [
          {
            id: "validationType",
            label: "ê²€ì¦ íƒ€ì…",
            type: "radio",
            options: ["ì‹¤ì‹œê°„", "ì œì¶œì‹œ"],
            defaultValue: "ì‹¤ì‹œê°„",
          },
          {
            id: "errorDisplay",
            label: "ì˜¤ë¥˜ í‘œì‹œ",
            type: "radio",
            options: ["ì¸ë¼ì¸", "íŒì—…"],
            defaultValue: "ì¸ë¼ì¸",
          },
        ];
      case "M02-2":
      case "M02-3":
        return [
          {
            id: "depth",
            label: "Depth",
            type: "radio",
            options: ["1", "2", "3"],
            defaultValue: moduleId === "M02-2" ? "2" : "3",
          },
          {
            id: "multiSelect",
            label: "ë‹¤ì¤‘ì„ íƒ",
            type: "toggle",
            defaultValue: false,
          },
          {
            id: "depthInfluence",
            label: "1Depth ì˜í–¥",
            type: "toggle",
            defaultValue: true,
          },
        ];
      case "M02-5":
        return [
          {
            id: "maxSelection",
            label: "ìµœëŒ€ ì„ íƒ ìˆ˜",
            type: "radio",
            options: ["ì œí•œì—†ìŒ", "3ê°œ", "5ê°œ"],
            defaultValue: "ì œí•œì—†ìŒ",
          },
          {
            id: "showCount",
            label: "ì„ íƒ ê°œìˆ˜ í‘œì‹œ",
            type: "toggle",
            defaultValue: true,
          },
        ];
      case "M04-1":
      case "M04-3":
        return [
          {
            id: "showImages",
            label: "ì´ë¯¸ì§€ í‘œì‹œ",
            type: "toggle",
            defaultValue: true,
          },
          {
            id: "groupByCategory",
            label: "ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë£¹",
            type: "toggle",
            defaultValue: true,
          },
          {
            id: "showPrice",
            label: "ê°€ê²© í‘œì‹œ",
            type: "toggle",
            defaultValue: true,
          },
        ];
      case "M04-6":
      case "M04-7":
        return [
          {
            id: "includeImages",
            label: "ì´ë¯¸ì§€ í¬í•¨",
            type: "toggle",
            defaultValue: true,
          },
          {
            id: "detailedBreakdown",
            label: "ìƒì„¸ ë¶„ë¥˜",
            type: "toggle",
            defaultValue: false,
          },
        ];
      default:
        return [];
    }
  };

  const getPreviewContent = (moduleId: string) => {
    const isMobile = deviceView === "mobile";
    const isTablet = deviceView === "tablet";

    // Device frame styles
    const deviceStyles = isMobile
      ? "w-[375px] max-h-[90%] border-[8px] border-slate-800 rounded-[3rem]"
      : isTablet
      ? "w-[768px] max-h-[90%] border-[12px] border-slate-800 rounded-[2rem]"
      : "w-full h-full border-none rounded-none";

    const contentContainerStyles = `bg-white shadow-2xl transition-all duration-300 overflow-y-auto flex-1 w-full relative ${
      isMobile || isTablet ? "w-full" : "w-full rounded-none"
    }`;

    // Wrapper for centering
    const Wrapper = ({ children }: { children: React.ReactNode }) => (
      <div
        className={`flex items-center justify-center h-full w-full p-8 bg-slate-100/50 ${
          !isMobile && !isTablet ? "p-0" : ""
        }`}
      >
        <div
          className={`${deviceStyles} bg-white shadow-xl overflow-hidden flex flex-col transition-all duration-300 relative`}
        >
          {/* Status Bar Mockup for Mobile/Tablet */}
          {(isMobile || isTablet) && (
            <div className="h-6 w-full bg-slate-800 flex items-center justify-between px-6 flex-none z-10">
              <div className="w-16 h-2 bg-slate-700 rounded-full opacity-50" />
            </div>
          )}
          <div className={contentContainerStyles}>{children}</div>
          {/* Home Indicator for Mobile */}
          {isMobile && (
            <div className="absolute bottom-2 left-1/2 -translate-x-1/2 w-32 h-1 bg-black/20 rounded-full z-10 pointer-events-none" />
          )}
        </div>
      </div>
    );

    switch (moduleId) {
      case "M01-1":
        return (
          <Wrapper>
            <div className="flex flex-col items-center justify-center min-h-full p-8">
              <div className="text-center max-w-md">
                {/* ë¡œê³  */}
                <div className="w-32 h-32 bg-primary/10 rounded-2xl mx-auto mb-6 flex items-center justify-center">
                  <Key className="h-16 w-16 text-primary" />
                </div>

                {/* ì œëª© */}
                <h2 className="text-2xl font-bold text-foreground mb-3">
                  ì˜µì…˜ ì‹œìŠ¤í…œ
                </h2>
                <p className="text-sm text-muted-foreground mb-8">
                  ê±´ì„¤ì‚¬ í†µí•© ì¸ì¦ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”
                </p>

                {/* SSO ë¡œê·¸ì¸ ë²„íŠ¼ */}
                <button className="w-full max-w-sm h-14 bg-primary rounded-lg flex items-center justify-center gap-3 text-white font-semibold hover:bg-primary/90 transition-colors mb-4">
                  <Key className="h-5 w-5" />
                  ê±´ì„¤ì‚¬ SSO ë¡œê·¸ì¸
                </button>

                {/* ì•ˆë‚´ ë©”ì‹œì§€ */}
                <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-xs text-left">
                  <p className="font-semibold text-blue-900 mb-1">
                    â„¹ï¸ SSO ì—°ë™ ì•ˆë‚´
                  </p>
                  <ul className="text-blue-800 space-y-1 list-disc list-inside">
                    <li>ê±´ì„¤ì‚¬ ê³„ì •ìœ¼ë¡œ ìë™ ë¡œê·¸ì¸ë©ë‹ˆë‹¤</li>
                    <li>ë³„ë„ì˜ íšŒì›ê°€ì…ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</li>
                    <li>ë³´ì•ˆ ì¸ì¦ì€ ê±´ì„¤ì‚¬ ì‹œìŠ¤í…œì„ ë”°ë¦…ë‹ˆë‹¤</li>
                  </ul>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M01-2":
        return (
          <Wrapper>
            <div className="flex flex-col items-center justify-center min-h-full p-8">
              <div className="w-full max-w-md">
                {/* ë¡œê³  */}
                <div className="w-20 h-20 bg-primary/10 rounded-xl mx-auto mb-6 flex items-center justify-center">
                  <span className="text-2xl font-bold text-primary">LOGO</span>
                </div>

                {/* ì œëª© */}
                <h2 className="text-2xl font-bold text-center text-foreground mb-2">
                  ë¡œê·¸ì¸
                </h2>
                <p className="text-sm text-center text-muted-foreground mb-8">
                  ì˜µì…˜ ì„ íƒì„ ìœ„í•´ ë¡œê·¸ì¸í•˜ì„¸ìš”
                </p>

                {/* ì—ëŸ¬ ë©”ì‹œì§€ */}
                {loginError && (
                  <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800">
                    {loginError}
                  </div>
                )}

                {/* ë¡œê·¸ì¸ í¼ */}
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-foreground mb-2">
                      ì•„ì´ë””
                    </label>
                    <Input
                      value={loginData.id}
                      onChange={(e) =>
                        setLoginData({ ...loginData, id: e.target.value })
                      }
                      placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                      className="h-12"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-foreground mb-2">
                      ë¹„ë°€ë²ˆí˜¸
                    </label>
                    <Input
                      type="password"
                      value={loginData.password}
                      onChange={(e) =>
                        setLoginData({ ...loginData, password: e.target.value })
                      }
                      placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                      className="h-12"
                    />
                  </div>

                  <button
                    onClick={handleLogin}
                    className="w-full h-14 bg-primary rounded-lg text-white font-semibold hover:bg-primary/90 transition-colors"
                  >
                    ë¡œê·¸ì¸
                  </button>

                  {/* ì¶”ê°€ ë§í¬ */}
                  <div className="flex justify-center gap-4 text-xs text-muted-foreground">
                    <button className="hover:text-foreground">
                      ì•„ì´ë”” ì°¾ê¸°
                    </button>
                    <span>|</span>
                    <button className="hover:text-foreground">
                      ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
                    </button>
                    <span>|</span>
                    <button className="hover:text-foreground">íšŒì›ê°€ì…</button>
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M01-3":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <div className="text-center mb-8 mt-4">
                <div className="w-20 h-20 bg-primary/10 rounded-xl mx-auto mb-4 flex items-center justify-center">
                  <span className="text-xl font-bold text-primary">LOGO</span>
                </div>
                <h2 className="text-xl font-bold text-foreground mb-2">
                  ì˜µì…˜ ì„ íƒì„ ìœ„í•œ ì •ë³´ ì…ë ¥
                </h2>
                <p className="text-sm text-muted-foreground">
                  ê³ ê° ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                </p>
              </div>

              <div className="space-y-4 w-full max-w-md mx-auto flex-1">
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ì´ë¦„ *
                  </label>
                  <div className="h-12 border-2 border-border rounded-lg bg-muted/20"></div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ì „í™”ë²ˆí˜¸ *
                  </label>
                  <div className="h-12 border-2 border-border rounded-lg bg-muted/20"></div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    íƒ€ì… *
                  </label>
                  <div className="h-12 border-2 border-border rounded-lg bg-muted/20 flex items-center justify-end px-3">
                    <ChevronDown className="h-5 w-5 text-muted-foreground" />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ë™/í˜¸ìˆ˜ *
                  </label>
                  <div className="h-12 border-2 border-border rounded-lg bg-muted/20"></div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ê³„ì•½ë²ˆí˜¸
                  </label>
                  <div className="h-12 border-2 border-border rounded-lg bg-muted/20"></div>
                </div>

                <div className="pt-6 pb-8">
                  <div className="h-14 bg-primary rounded-lg flex items-center justify-center cursor-pointer hover:bg-primary/90 transition-colors">
                    <span className="text-white font-semibold text-lg">
                      ì…ë ¥ ì™„ë£Œ
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M01-4":
        // Validation logic
        const validateName = (value: string) => {
          if (!value) return "ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”";
          if (value.length < 2) return "ì´ë¦„ì„ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”";
          return "";
        };

        const validatePhone = (value: string) => {
          if (!value) return "ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”";
          const numbersOnly = value.replace(/[^0-9]/g, "");
          if (!/^[0-9]*$/.test(value)) return "ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤";
          if (numbersOnly.length !== 11) return "11ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”";
          return "";
        };

        const validateType = (value: string) => {
          if (!value) return "íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”";
          return "";
        };

        const validateUnit = (value: string) => {
          if (!value) return "ë™/í˜¸ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”";
          return "";
        };

        const isRealtime = conditions.validationType === "ì‹¤ì‹œê°„";
        const nameError =
          isRealtime || submitAttempted ? validateName(formData.name) : "";
        const phoneError =
          isRealtime || submitAttempted ? validatePhone(formData.phone) : "";
        const typeError =
          isRealtime || submitAttempted ? validateType(formData.type) : "";
        const unitError =
          isRealtime || submitAttempted ? validateUnit(formData.unit) : "";

        const hasErrors = !!(nameError || phoneError || typeError || unitError);
        const allFieldsFilled =
          formData.name && formData.phone && formData.type && formData.unit;

        const handleSubmit = () => {
          console.log("[v0] Form submit attempted");
          setSubmitAttempted(true);

          if (!hasErrors && allFieldsFilled) {
            console.log("[v0] Form validation passed");
            setShowSubmitSuccess(true);
            setTimeout(() => setShowSubmitSuccess(false), 3000);
          } else {
            console.log("[v0] Form validation failed");
          }
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì •ë³´ ê²€ì¦
              </h2>

              {/* Error Summary for ì œì¶œì‹œ validation */}
              {!isRealtime && submitAttempted && hasErrors && (
                <div className="mb-6 p-4 bg-red-50 border-2 border-red-200 rounded-lg">
                  <p className="text-sm font-semibold text-red-900 mb-2">
                    ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•´ì£¼ì„¸ìš”:
                  </p>
                  <ul className="text-xs text-red-700 space-y-1 list-disc list-inside">
                    {nameError && <li>{nameError}</li>}
                    {phoneError && <li>{phoneError}</li>}
                    {typeError && <li>{typeError}</li>}
                    {unitError && <li>{unitError}</li>}
                  </ul>
                </div>
              )}

              {/* Success Message */}
              {showSubmitSuccess && (
                <div className="mb-6 p-4 bg-green-50 border-2 border-green-500 rounded-lg flex items-center gap-3">
                  <Check className="h-5 w-5 text-green-600" />
                  <p className="text-sm font-semibold text-green-900">
                    ì…ë ¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤
                  </p>
                </div>
              )}

              <div className="space-y-4 w-full max-w-md mx-auto flex-1">
                {/* Name Input */}
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ì´ë¦„ *
                  </label>
                  <div className="relative">
                    <Input
                      value={formData.name}
                      onChange={(e) => {
                        setFormData({ ...formData, name: e.target.value });
                        setSubmitAttempted(false);
                      }}
                      className={`h-12 ${
                        nameError
                          ? "border-red-500 bg-red-50"
                          : formData.name && !nameError
                          ? "border-green-500 bg-green-50"
                          : ""
                      }`}
                      placeholder="ì´ë¦„ ì…ë ¥"
                    />
                    {formData.name && !nameError && (
                      <Check className="absolute right-3 top-3 h-6 w-6 text-green-600" />
                    )}
                  </div>
                  {nameError && isRealtime && (
                    <p className="text-xs text-red-600 mt-1 flex items-center gap-1">
                      <X className="h-3 w-3" />
                      {nameError}
                    </p>
                  )}
                  {formData.name && !nameError && isRealtime && (
                    <p className="text-xs text-green-600 mt-1 flex items-center gap-1">
                      <Check className="h-3 w-3" />
                      ìœ íš¨í•œ ì´ë¦„ì…ë‹ˆë‹¤
                    </p>
                  )}
                </div>

                {/* Phone Input */}
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ì „í™”ë²ˆí˜¸ *
                  </label>
                  <div className="relative">
                    <Input
                      value={formData.phone}
                      onChange={(e) => {
                        setFormData({ ...formData, phone: e.target.value });
                        setSubmitAttempted(false);
                      }}
                      className={`h-12 ${
                        phoneError
                          ? "border-red-500 bg-red-50"
                          : formData.phone && !phoneError
                          ? "border-green-500 bg-green-50"
                          : ""
                      }`}
                      placeholder="010-1234-5678"
                    />
                    {formData.phone && !phoneError && (
                      <Check className="absolute right-3 top-3 h-6 w-6 text-green-600" />
                    )}
                  </div>
                  {phoneError && isRealtime && (
                    <p className="text-xs text-red-600 mt-1 flex items-center gap-1">
                      <X className="h-3 w-3" />
                      {phoneError}
                    </p>
                  )}
                  {formData.phone && !phoneError && isRealtime && (
                    <p className="text-xs text-green-600 mt-1 flex items-center gap-1">
                      <Check className="h-3 w-3" />
                      ìœ íš¨í•œ ì „í™”ë²ˆí˜¸ì…ë‹ˆë‹¤
                    </p>
                  )}
                </div>

                {/* Type Dropdown */}
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    íƒ€ì… *
                  </label>
                  <select
                    value={formData.type}
                    onChange={(e) => {
                      setFormData({ ...formData, type: e.target.value });
                      setSubmitAttempted(false);
                    }}
                    className={`w-full h-12 border-2 rounded-lg px-3 bg-white ${
                      typeError
                        ? "border-red-500 bg-red-50"
                        : formData.type && !typeError
                        ? "border-green-500 bg-green-50"
                        : "border-border"
                    }`}
                  >
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="84A">84Aíƒ€ì…</option>
                    <option value="84B">84Bíƒ€ì…</option>
                    <option value="108">108íƒ€ì…</option>
                  </select>
                  {typeError && isRealtime && (
                    <p className="text-xs text-red-600 mt-1 flex items-center gap-1">
                      <X className="h-3 w-3" />
                      {typeError}
                    </p>
                  )}
                </div>

                {/* Unit Input */}
                <div>
                  <label className="block text-sm font-medium text-foreground mb-2">
                    ë™/í˜¸ìˆ˜ *
                  </label>
                  <div className="relative">
                    <Input
                      value={formData.unit}
                      onChange={(e) => {
                        setFormData({ ...formData, unit: e.target.value });
                        setSubmitAttempted(false);
                      }}
                      className={`h-12 ${
                        unitError
                          ? "border-red-500 bg-red-50"
                          : formData.unit && !unitError
                          ? "border-green-500 bg-green-50"
                          : ""
                      }`}
                      placeholder="101ë™ 1001í˜¸"
                    />
                    {formData.unit && !unitError && (
                      <Check className="absolute right-3 top-3 h-6 w-6 text-green-600" />
                    )}
                  </div>
                  {unitError && isRealtime && (
                    <p className="text-xs text-red-600 mt-1 flex items-center gap-1">
                      <X className="h-3 w-3" />
                      {unitError}
                    </p>
                  )}
                </div>

                {/* Submit Button */}
                <div className="pt-6 pb-8">
                  <button
                    onClick={handleSubmit}
                    disabled={isRealtime && (hasErrors || !allFieldsFilled)}
                    className={`w-full h-14 rounded-lg flex items-center justify-center transition-all ${
                      isRealtime && (hasErrors || !allFieldsFilled)
                        ? "bg-gray-300 text-gray-500 cursor-not-allowed"
                        : "bg-primary text-white hover:bg-primary/90 cursor-pointer"
                    }`}
                  >
                    <span className="font-semibold text-lg">ì…ë ¥ ì™„ë£Œ</span>
                  </button>
                </div>
              </div>
            </div>
          </Wrapper>
        );
      case "M01-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì…ë ¥ ì •ë³´ í™•ì¸
              </h2>

              {/* ì…ë ¥ëœ ì •ë³´ í‘œì‹œ */}
              <div className="space-y-4 max-w-md mx-auto w-full flex-1">
                <div className="p-4 border-2 border-border rounded-lg bg-muted/20">
                  <div className="grid grid-cols-2 gap-3 text-sm">
                    <div>
                      <span className="text-muted-foreground">ì´ë¦„</span>
                      <p className="font-semibold text-foreground mt-1">
                        {userInfo.name}
                      </p>
                    </div>
                    <div>
                      <span className="text-muted-foreground">ì „í™”ë²ˆí˜¸</span>
                      <p className="font-semibold text-foreground mt-1">
                        {userInfo.phone}
                      </p>
                    </div>
                    <div>
                      <span className="text-muted-foreground">íƒ€ì…</span>
                      <p className="font-semibold text-foreground mt-1">
                        {userInfo.type}
                      </p>
                    </div>
                    <div>
                      <span className="text-muted-foreground">ë™/í˜¸ìˆ˜</span>
                      <p className="font-semibold text-foreground mt-1">
                        {userInfo.unit}
                      </p>
                    </div>
                  </div>
                </div>

                {/* ìˆ˜ì • ì•ˆë‚´ */}
                <div className="p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-xs text-yellow-800">
                  <p className="font-semibold mb-1">âš ï¸ ì •ë³´ ìˆ˜ì • ë°©ë²•</p>
                  <p>Q2-4 ë‹µë³€ì— ë”°ë¼ ìˆ˜ì • ë°©ë²•ì´ ê²°ì •ë©ë‹ˆë‹¤:</p>
                  <ul className="mt-1 list-disc list-inside space-y-0.5">
                    <li>"ìƒˆë¡œê³ ì¹¨": í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì¬ì…ë ¥</li>
                    <li>"ìˆ˜ì • ë²„íŠ¼": ì•„ë˜ ìˆ˜ì • ë²„íŠ¼ í´ë¦­</li>
                    <li>"ë¶ˆê°€": ìˆ˜ì • ë¶ˆê°€ëŠ¥</li>
                  </ul>
                </div>

                {/* ìˆ˜ì • ë²„íŠ¼ (Q2-4ì— ë”°ë¼ ì¡°ê±´ë¶€ í‘œì‹œ) */}
                <button
                  className="w-full h-12 border-2 border-primary text-primary rounded-lg font-semibold hover:bg-primary hover:text-white transition-colors"
                  onClick={() => setIsEditing(true)}
                >
                  ì •ë³´ ìˆ˜ì •í•˜ê¸°
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M01-6":
        return (
          <Wrapper>
            <div className="flex flex-col h-full">
              {/* ìƒë‹¨ ê³ ì • í—¤ë” */}
              <div className="sticky top-0 z-10 bg-white border-b-2 border-border shadow-sm">
                <div className="p-4 flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <div className="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center">
                      <span className="text-sm font-bold text-primary">
                        LOGO
                      </span>
                    </div>
                    <div className="flex items-center gap-3 text-sm">
                      <Badge variant="secondary" className="px-3 py-1">
                        í™ê¸¸ë™
                      </Badge>
                      <Badge variant="outline" className="px-3 py-1">
                        84Aíƒ€ì…
                      </Badge>
                      <Badge variant="outline" className="px-3 py-1">
                        101ë™ 1001í˜¸
                      </Badge>
                    </div>
                  </div>
                  <button className="text-xs text-muted-foreground hover:text-foreground underline">
                    ì •ë³´ ìˆ˜ì •
                  </button>
                </div>
              </div>

              {/* ë³¸ë¬¸ ì»¨í…ì¸  */}
              <div className="flex-1 p-8 overflow-auto">
                <div className="max-w-2xl mx-auto">
                  <h2 className="text-2xl font-bold text-foreground mb-4">
                    ì˜µì…˜ ì„ íƒ í™”ë©´
                  </h2>
                  <p className="text-muted-foreground mb-8">
                    ìƒë‹¨ì— ì…ë ¥í•˜ì‹  ì •ë³´ê°€ í•­ìƒ í‘œì‹œë©ë‹ˆë‹¤.
                  </p>

                  {/* ì˜ˆì‹œ ì»¨í…ì¸  */}
                  <div className="space-y-4">
                    {[1, 2, 3, 4, 5].map((i) => (
                      <div
                        key={i}
                        className="p-6 border-2 border-border rounded-lg bg-muted/20"
                      >
                        <p className="font-semibold text-foreground mb-2">
                          ì˜µì…˜ ì¹´í…Œê³ ë¦¬ {i}
                        </p>
                        <p className="text-sm text-muted-foreground">
                          ì˜µì…˜ ì„ íƒ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                        </p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );
      case "M02-1":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                1Depth ì˜µì…˜ ì„ íƒ
              </h2>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                {sampleOptionData.depth1Options.map((option) => {
                  const isSelected = selected1Depth === option.id;
                  return (
                    <div
                      key={option.id}
                      onClick={() => setSelected1Depth(option.id)}
                      className={`relative p-6 border-2 rounded-xl cursor-pointer transition-all ${
                        isSelected
                          ? "border-primary bg-primary/5 shadow-lg"
                          : "border-border hover:border-primary/50"
                      }`}
                    >
                      {/* ì´ë¯¸ì§€ */}
                      <div className="w-full h-40 bg-muted rounded-lg mb-4 flex items-center justify-center">
                        <span className="text-4xl">ğŸ </span>
                      </div>

                      {/* ì˜µì…˜ëª… */}
                      <h3 className="text-lg font-bold text-foreground mb-2">
                        {option.name}
                      </h3>
                      <p className="text-sm text-muted-foreground mb-3">
                        {option.description}
                      </p>

                      {/* ê°€ê²© */}
                      <div className="flex items-center justify-between">
                        <span
                          className={`text-xl font-bold ${
                            option.price === 0
                              ? "text-muted-foreground"
                              : "text-primary"
                          }`}
                        >
                          {option.price === 0
                            ? "ê¸°ë³¸"
                            : `+${(option.price / 10000).toLocaleString()}ë§Œì›`}
                        </span>
                        {option.isDefault && (
                          <Badge variant="secondary" className="text-xs">
                            ê¸°ë³¸
                          </Badge>
                        )}
                      </div>

                      {/* ì„ íƒ í‘œì‹œ */}
                      {isSelected && (
                        <div className="absolute top-4 right-4 w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                          <Check className="h-5 w-5 text-white" />
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>

              {/* ì•ˆë‚´ ë©”ì‹œì§€ */}
              <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm">
                <p className="font-semibold text-blue-900 mb-1">
                  ğŸ“‹ 1Depth ì˜µì…˜
                </p>
                <p className="text-blue-800">
                  í‰ë©´ íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”. ì„ íƒí•œ íƒ€ì…ì— ë”°ë¼ í•˜ìœ„ ì˜µì…˜ì´
                  ë‹¬ë¼ì§‘ë‹ˆë‹¤.
                </p>
              </div>
            </div>
          </Wrapper>
        );

      case "M02-2":
        // Calculate total price
        let totalPrice = 0;
        if (selectedPackage) totalPrice += 5000000;

        const doorOptions =
          selectedPackage && conditions.depthInfluence
            ? [
                {
                  value: "premium-a",
                  label: "í”„ë¦¬ë¯¸ì—„ Aí˜•",
                  price: 0,
                  included: true,
                },
                { value: "premium-b", label: "í”„ë¦¬ë¯¸ì—„ Bí˜•", price: 300000 },
              ]
            : [
                { value: "standard", label: "ì¼ë°˜í˜•", price: 500000 },
                { value: "premium", label: "í”„ë¦¬ë¯¸ì—„í˜•", price: 800000 },
              ];

        if (selectedOptions.aircon === "partial") totalPrice += 1000000;
        if (selectedOptions.aircon === "full") totalPrice += 2000000;

        const selectedDoorOption = doorOptions.find(
          (opt) => opt.value === selectedOptions.door
        );
        if (selectedDoorOption) totalPrice += selectedDoorOption.price;

        if (selectedOptions.closet === "two") totalPrice += 2000000;
        if (selectedOptions.closet === "three") totalPrice += 3000000;

        // For multiselect closet
        const isMultiSelect = conditions.multiSelect;
        const multiClosetSelections = selectedOptions.closet
          ? selectedOptions.closet.split(",")
          : [];
        if (isMultiSelect) {
          totalPrice = 0;
          if (selectedPackage) totalPrice += 5000000;
          if (selectedOptions.aircon === "partial") totalPrice += 1000000;
          if (selectedOptions.aircon === "full") totalPrice += 2000000;
          if (selectedDoorOption) totalPrice += selectedDoorOption.price;
          if (multiClosetSelections.includes("two")) totalPrice += 2000000;
          if (multiClosetSelections.includes("three")) totalPrice += 3000000;
        }

        const formatPrice = (price: number) =>
          price.toLocaleString("ko-KR") + "ì›";

        const handlePackageToggle = () => {
          if (selectedPackage && conditions.depthInfluence) {
            setShowPackageConfirm(true);
          } else {
            setSelectedPackage(!selectedPackage);
          }
        };

        const confirmPackageRemoval = (confirm: boolean) => {
          if (confirm) {
            setSelectedPackage(false);
            setSelectedOptions({ ...selectedOptions, door: "" });
          }
          setShowPackageConfirm(false);
        };

        const handleClosetChange = (value: string) => {
          if (isMultiSelect) {
            const current = multiClosetSelections;
            const newSelections = current.includes(value)
              ? current.filter((v) => v !== value)
              : [...current, value];
            setSelectedOptions({
              ...selectedOptions,
              closet: newSelections.join(","),
            });
          } else {
            setSelectedOptions({ ...selectedOptions, closet: value });
          }
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                2Depth ì˜µì…˜ ì„ íƒ
              </h2>

              {/* Confirmation Modal */}
              {showPackageConfirm && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 rounded-[inherit]">
                  <div className="bg-white rounded-xl p-6 max-w-sm mx-4 shadow-2xl">
                    <h3 className="text-lg font-bold text-foreground mb-3">
                      íŒ¨í‚¤ì§€ í•´ì œ í™•ì¸
                    </h3>
                    <p className="text-sm text-muted-foreground mb-6">
                      íŒ¨í‚¤ì§€ë¥¼ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ê´€ë ¨ ì˜µì…˜ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.
                    </p>
                    <div className="flex gap-3">
                      <button
                        onClick={() => confirmPackageRemoval(false)}
                        className="flex-1 h-12 border-2 border-border rounded-lg font-semibold hover:bg-muted/50 transition-colors"
                      >
                        ì·¨ì†Œ
                      </button>
                      <button
                        onClick={() => confirmPackageRemoval(true)}
                        className="flex-1 h-12 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors"
                      >
                        í•´ì œí•˜ê¸°
                      </button>
                    </div>
                  </div>
                </div>
              )}

              <div
                className={`grid ${
                  isMobile ? "grid-cols-1" : "grid-cols-2"
                } gap-6 flex-1`}
              >
                {/* LEFT: 1Depth Package Options */}
                <div className="space-y-4">
                  <h3 className="text-base font-bold text-foreground mb-3">
                    [íŒ¨í‚¤ì§€ ì˜µì…˜]
                  </h3>

                  <div
                    onClick={handlePackageToggle}
                    role="button"
                    tabIndex={0}
                    className={`w-full p-4 rounded-lg border-2 transition-all text-left cursor-pointer ${
                      selectedPackage
                        ? "border-primary bg-primary/10"
                        : "border-border hover:border-primary/50"
                    }`}
                  >
                    <div className="flex items-start gap-3">
                      <div className="mt-1">
                        <Checkbox
                          checked={selectedPackage}
                          className="h-5 w-5"
                        />
                      </div>
                      <div className="flex-1">
                        <p className="text-sm font-semibold text-foreground mb-1">
                          í”„ë¦¬ë¯¸ì—„ ê°€êµ¬ íŒ¨í‚¤ì§€
                        </p>
                        <p className="text-sm font-bold text-primary">
                          + 5,000,000ì›
                        </p>
                        {selectedPackage && conditions.depthInfluence && (
                          <Badge className="mt-2 bg-blue-500 text-white text-xs">
                            íŒ¨í‚¤ì§€ ì ìš©ë¨
                          </Badge>
                        )}
                      </div>
                    </div>
                  </div>
                </div>

                {/* RIGHT: 2Depth Individual Options */}
                <div className="space-y-4">
                  <h3 className="text-base font-bold text-foreground mb-3">
                    [ê°œë³„ ì„ íƒ]
                  </h3>

                  {/* ì‹œìŠ¤í…œì—ì–´ì»¨ */}
                  <div className="border-2 border-border rounded-lg p-4">
                    <div className="flex items-center gap-2 mb-3">
                      <ChevronDown className="h-4 w-4 text-muted-foreground" />
                      <span className="text-sm font-semibold text-foreground">
                        ì‹œìŠ¤í…œì—ì–´ì»¨
                      </span>
                    </div>
                    <div className="space-y-2 ml-6">
                      {[
                        { value: "", label: "ë¯¸ì„ íƒ", price: 0 },
                        {
                          value: "partial",
                          label: "ê±°ì‹¤+ì¹¨ì‹¤",
                          price: 1000000,
                        },
                        { value: "full", label: "ì „ì²´", price: 2000000 },
                      ].map((option) => (
                        <label
                          key={option.value}
                          className="flex items-center gap-2 cursor-pointer"
                        >
                          <input
                            type="radio"
                            name="aircon"
                            value={option.value}
                            checked={selectedOptions.aircon === option.value}
                            onChange={(e) =>
                              setSelectedOptions({
                                ...selectedOptions,
                                aircon: e.target.value,
                              })
                            }
                            className="w-4 h-4"
                          />
                          <span className="text-sm text-foreground">
                            {option.label}{" "}
                            {option.price > 0 &&
                              `(+ ${(option.price / 10000).toFixed(0)}ë§Œì›)`}
                          </span>
                        </label>
                      ))}
                    </div>
                  </div>

                  {/* í˜„ê´€ì¤‘ë¬¸ */}
                  <div className="border-2 border-border rounded-lg p-4 transition-all duration-300">
                    <div className="flex items-center gap-2 mb-3">
                      <ChevronDown className="h-4 w-4 text-muted-foreground" />
                      <span className="text-sm font-semibold text-foreground">
                        í˜„ê´€ì¤‘ë¬¸
                      </span>
                    </div>
                    <div className="space-y-2 ml-6">
                      {doorOptions.map((option) => (
                        <label
                          key={option.value}
                          className="flex items-center gap-2 cursor-pointer"
                        >
                          <input
                            type="radio"
                            name="door"
                            value={option.value}
                            checked={selectedOptions.door === option.value}
                            onChange={(e) =>
                              setSelectedOptions({
                                ...selectedOptions,
                                door: e.target.value,
                              })
                            }
                            className="w-4 h-4"
                          />
                          <span className="text-sm text-foreground">
                            {option.label}{" "}
                            {option.included
                              ? "(í¬í•¨)"
                              : option.price > 0
                              ? `(+ ${(option.price / 10000).toFixed(0)}ë§Œì›)`
                              : ""}
                          </span>
                        </label>
                      ))}
                    </div>
                  </div>

                  {/* ì¹¨ì‹¤ ë¶™ë°•ì´ì¥ */}
                  <div className="border-2 border-border rounded-lg p-4">
                    <div className="flex items-center justify-between mb-3">
                      <div className="flex items-center gap-2">
                        <ChevronDown className="h-4 w-4 text-muted-foreground" />
                        <span className="text-sm font-semibold text-foreground">
                          ì¹¨ì‹¤ ë¶™ë°•ì´ì¥
                        </span>
                      </div>
                      {isMultiSelect && multiClosetSelections.length > 0 && (
                        <Badge variant="secondary" className="text-xs">
                          ì„ íƒë¨: {multiClosetSelections.length}ê°œ
                        </Badge>
                      )}
                    </div>
                    <div className="space-y-2 ml-6">
                      {[
                        { value: "two", label: "2ê°œì‹¤", price: 2000000 },
                        { value: "three", label: "3ê°œì‹¤", price: 3000000 },
                      ].map((option) => (
                        <label
                          key={option.value}
                          className="flex items-center gap-2 cursor-pointer"
                        >
                          {isMultiSelect ? (
                            <Checkbox
                              checked={multiClosetSelections.includes(
                                option.value
                              )}
                              onCheckedChange={() =>
                                handleClosetChange(option.value)
                              }
                              className="h-4 w-4"
                            />
                          ) : (
                            <input
                              type="radio"
                              name="closet"
                              value={option.value}
                              checked={selectedOptions.closet === option.value}
                              onChange={(e) =>
                                setSelectedOptions({
                                  ...selectedOptions,
                                  closet: e.target.value,
                                })
                              }
                              className="w-4 h-4"
                            />
                          )}
                          <span className="text-sm text-foreground">
                            {option.label} (+{" "}
                            {(option.price / 10000).toFixed(0)}ë§Œì›)
                          </span>
                        </label>
                      ))}
                    </div>
                  </div>
                </div>
              </div>

              {/* Total Price */}
              <div className="mt-8 pt-6 border-t-2 border-border pb-8">
                <div className="flex items-center justify-between">
                  <span className="text-lg font-bold text-foreground">
                    ì´ ì˜µì…˜ ê¸ˆì•¡:
                  </span>
                  <span className="text-3xl font-bold text-primary transition-all duration-300">
                    {formatPrice(totalPrice)}
                  </span>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M02-3":
        const depth = 3;
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                {depth}Depth ì˜µì…˜ ì„ íƒ
              </h2>

              <div className="space-y-6 flex-1">
                {/* 1Depth */}
                <div>
                  <label className="block text-sm font-semibold text-foreground mb-3">
                    ì¹´í…Œê³ ë¦¬ ì„ íƒ
                  </label>
                  <div
                    className={`grid ${
                      isMobile ? "grid-cols-1" : "grid-cols-3"
                    } gap-3`}
                  >
                    {["ê°€êµ¬ íŒ¨í‚¤ì§€", "ì‹œìŠ¤í…œì—ì–´ì»¨", "ë¶™ë°•ì´ì¥"].map(
                      (item, i) => (
                        <div
                          key={item}
                          className={`h-20 rounded-lg border-2 flex items-center justify-center text-sm font-medium transition-all ${
                            i === 0
                              ? "border-primary bg-primary/10 text-primary"
                              : "border-border bg-muted/20 text-muted-foreground"
                          }`}
                        >
                          {item}
                        </div>
                      )
                    )}
                  </div>
                </div>

                {/* 2Depth */}
                <div>
                  <label className="block text-sm font-semibold text-foreground mb-3">
                    ì„¸ë¶€ ì˜µì…˜
                  </label>
                  <div className="grid grid-cols-2 gap-3">
                    {["í”„ë¦¬ë¯¸ì—„", "ìŠ¤íƒ ë‹¤ë“œ"].map((item, i) => (
                      <div
                        key={item}
                        className={`h-16 rounded-lg border-2 flex items-center justify-center text-sm font-medium ${
                          i === 0
                            ? "border-primary bg-primary/10 text-primary"
                            : "border-border bg-muted/20 text-muted-foreground"
                        }`}
                      >
                        {item}
                      </div>
                    ))}
                  </div>
                </div>

                {/* 3Depth */}
                <div>
                  <label className="block text-sm font-semibold text-foreground mb-3">
                    ì¶”ê°€ ì˜µì…˜
                  </label>
                  <div className="space-y-2">
                    {["ì˜µì…˜ A", "ì˜µì…˜ B", "ì˜µì…˜ C"].map((item, i) => (
                      <div
                        key={item}
                        className={`h-12 rounded-lg border-2 px-4 flex items-center text-sm font-medium ${
                          i === 0
                            ? "border-primary bg-primary/10 text-primary"
                            : "border-border bg-muted/20 text-muted-foreground"
                        }`}
                      >
                        <div className="w-5 h-5 rounded border-2 border-current mr-3"></div>
                        {item}
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );
      case "M02-4":
        // 1Depthì— ë”°ë¼ ì‚¬ìš© ê°€ëŠ¥í•œ 2Depth ì˜µì…˜ í•„í„°ë§
        const available2DepthOptions = sampleOptionData.depth2Options.filter(
          (opt) => {
            if (opt.parent) {
              return opt.parent === main1Depth;
            }
            return true; // parent ì—†ìœ¼ë©´ í•­ìƒ ì‚¬ìš© ê°€ëŠ¥
          }
        );

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                1Depth ì—°ë™ ë¡œì§
              </h2>

              {/* 1Depth ì„ íƒ */}
              <div className="mb-8">
                <h3 className="text-base font-semibold mb-3">í‰ë©´ íƒ€ì… ì„ íƒ</h3>
                <div className="grid grid-cols-3 gap-3">
                  {sampleOptionData.depth1Options.map((option) => (
                    <button
                      key={option.id}
                      onClick={() => {
                        setMain1Depth(option.id);
                        setDependent2Depth([]); // 1Depth ë³€ê²½ ì‹œ 2Depth ì´ˆê¸°í™”
                      }}
                      className={`p-4 border-2 rounded-lg font-semibold transition-all ${
                        main1Depth === option.id
                          ? "border-primary bg-primary text-white"
                          : "border-border hover:border-primary/50"
                      }`}
                    >
                      {option.name}
                    </button>
                  ))}
                </div>
              </div>

              {/* 2Depth ì˜µì…˜ (1Depthì— ë”°ë¼ ë‹¬ë¼ì§) */}
              <div>
                <h3 className="text-base font-semibold mb-3">
                  ì„¸ë¶€ ì˜µì…˜ ({available2DepthOptions.length}ê°œ ì‚¬ìš© ê°€ëŠ¥)
                </h3>
                <div className="space-y-2">
                  {available2DepthOptions.map((option) => (
                    <div
                      key={option.id}
                      className={`p-4 border-2 rounded-lg ${
                        dependent2Depth.includes(option.id)
                          ? "border-primary bg-primary/5"
                          : "border-border"
                      }`}
                    >
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3">
                          <Checkbox
                            checked={dependent2Depth.includes(option.id)}
                            onCheckedChange={(checked) => {
                              if (checked) {
                                setDependent2Depth([
                                  ...dependent2Depth,
                                  option.id,
                                ]);
                              } else {
                                setDependent2Depth(
                                  dependent2Depth.filter(
                                    (id) => id !== option.id
                                  )
                                );
                              }
                            }}
                          />
                          <div>
                            <p className="font-semibold text-foreground">
                              {option.name}
                            </p>
                            <p className="text-xs text-muted-foreground">
                              {option.category}
                            </p>
                          </div>
                        </div>
                        <span className="text-sm font-bold text-primary">
                          +{(option.price / 10000).toLocaleString()}ë§Œì›
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* ì—°ë™ ì„¤ëª… */}
              <div className="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-sm">
                <p className="font-semibold text-yellow-900 mb-1">
                  âš™ï¸ 1Depth ì—°ë™
                </p>
                <p className="text-yellow-800">
                  "í™•ì¥í˜•"ì„ ì„ íƒí•˜ë©´ "ì£¼ë°© ê°€êµ¬ì¥" ì˜µì…˜ì´ í™œì„±í™”ë©ë‹ˆë‹¤. ë‹¤ë¥¸
                  íƒ€ì…ì„ ì„ íƒí•˜ë©´ í•´ë‹¹ ì˜µì…˜ì´ ìˆ¨ê²¨ì§‘ë‹ˆë‹¤.
                </p>
              </div>
            </div>
          </Wrapper>
        );
      case "M02-5":
        const maxSelection = 3; // ìµœëŒ€ 3ê°œ ì„ íƒ

        const handleMultiToggle = (optionId: string) => {
          if (multiSelection.includes(optionId)) {
            setMultiSelection(multiSelection.filter((id) => id !== optionId));
          } else {
            if (multiSelection.length < maxSelection) {
              setMultiSelection([...multiSelection, optionId]);
            } else {
              alert(`ìµœëŒ€ ${maxSelection}ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤`);
            }
          }
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <div className="flex items-center justify-between mb-6">
                <h2 className="text-xl font-bold text-foreground">
                  ë‹¤ì¤‘ ì„ íƒ ê¸°ëŠ¥
                </h2>
                <Badge variant="secondary" className="px-3 py-1">
                  ì„ íƒë¨: {multiSelection.length}/{maxSelection}
                </Badge>
              </div>

              <div className="space-y-3">
                {sampleOptionData.depth2Options.slice(0, 5).map((option) => {
                  const isSelected = multiSelection.includes(option.id);
                  const isDisabled =
                    !isSelected && multiSelection.length >= maxSelection;

                  return (
                    <div
                      key={option.id}
                      onClick={() =>
                        !isDisabled && handleMultiToggle(option.id)
                      }
                      className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                        isSelected
                          ? "border-primary bg-primary/5"
                          : isDisabled
                          ? "border-border bg-muted/50 opacity-50 cursor-not-allowed"
                          : "border-border hover:border-primary/50"
                      }`}
                    >
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3">
                          <Checkbox
                            checked={isSelected}
                            disabled={isDisabled}
                            className="h-5 w-5"
                          />
                          <div>
                            <p className="font-semibold text-foreground">
                              {option.name}
                            </p>
                            <p className="text-xs text-muted-foreground">
                              {option.category}
                            </p>
                          </div>
                        </div>
                        <span className="text-sm font-bold text-primary">
                          +{(option.price / 10000).toLocaleString()}ë§Œì›
                        </span>
                      </div>
                    </div>
                  );
                })}
              </div>

              {/* ì„ íƒ ì œí•œ ì•ˆë‚´ */}
              {multiSelection.length >= maxSelection && (
                <div className="mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg text-sm">
                  <p className="font-semibold text-orange-900 mb-1">
                    âš ï¸ ì„ íƒ ì œí•œ
                  </p>
                  <p className="text-orange-800">
                    ìµœëŒ€ ${maxSelection}ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ì˜µì…˜ì„
                    ì„ íƒí•˜ë ¤ë©´ ê¸°ì¡´ ì„ íƒì„ í•´ì œí•˜ì„¸ìš”.
                  </p>
                </div>
              )}
            </div>
          </Wrapper>
        );
      case "M02-6":
        // ê¸°ë³¸ê°’ ì„¤ì • (isDefault: trueì¸ ì˜µì…˜)
        const defaultOption = sampleOptionData.depth1Options.find(
          (opt) => opt.isDefault
        );
        // Note: currentSelection is initialized in useEffect

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì˜µì…˜ ê¸°ë³¸ê°’ ì„¤ì •
              </h2>

              {/* ê¸°ë³¸ê°’ ì•ˆë‚´ */}
              <div className="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                <p className="font-semibold text-green-900 mb-1">
                  âœ“ ê¸°ë³¸ê°’ ì„¤ì •ë¨
                </p>
                <p className="text-sm text-green-800">
                  ì‹œìŠ¤í…œ ì§„ì… ì‹œ "<strong>{defaultOption?.name}</strong>" ì˜µì…˜ì´
                  ìë™ìœ¼ë¡œ ì„ íƒë©ë‹ˆë‹¤.
                </p>
              </div>

              {/* ì˜µì…˜ ì„ íƒ */}
              <div className="grid grid-cols-3 gap-3">
                {sampleOptionData.depth1Options.map((option) => {
                  const isSelected = currentSelection === option.id;
                  return (
                    <div
                      key={option.id}
                      onClick={() => setCurrentSelection(option.id)}
                      className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                        isSelected
                          ? "border-primary bg-primary/5"
                          : "border-border hover:border-primary/50"
                      }`}
                    >
                      <div className="flex items-center justify-between mb-2">
                        <span className="font-semibold text-foreground">
                          {option.name}
                        </span>
                        {option.isDefault && (
                          <Badge variant="default" className="text-xs">
                            ê¸°ë³¸
                          </Badge>
                        )}
                      </div>
                      <span className="text-sm text-primary font-bold">
                        {option.price === 0
                          ? "ê¸°ë³¸ê°€"
                          : `+${(option.price / 10000).toLocaleString()}ë§Œì›`}
                      </span>
                    </div>
                  );
                })}
              </div>

              {/* ê¸°ë³¸ê°’ ì„¤ì • ë°©ë²• ì•ˆë‚´ */}
              <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm">
                <p className="font-semibold text-blue-900 mb-2">
                  ğŸ“‹ ê¸°ë³¸ê°’ ì„¤ì • ë°©ë²• (Q3-4 ë‹µë³€ ê¸°ë°˜)
                </p>
                <ul className="text-blue-800 space-y-1 list-disc list-inside">
                  <li>
                    <strong>ë¯¸ì„ íƒ</strong>: ì•„ë¬´ê²ƒë„ ì„ íƒí•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì‹œì‘
                  </li>
                  <li>
                    <strong>ê¸°ë³¸ì˜µì…˜</strong>: isDefault=trueì¸ ì˜µì…˜ ìë™ ì„ íƒ
                    âœ…
                  </li>
                  <li>
                    <strong>ì´ì „ ì„ íƒê°’ ìœ ì§€</strong>: ë§ˆì§€ë§‰ ì„ íƒê°’ì„
                    localStorageì— ì €ì¥
                  </li>
                </ul>
              </div>
            </div>
          </Wrapper>
        );

      case "M02-7":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì˜µì…˜ë³„ ê°€ê²© í‘œì‹œ
              </h2>

              <div className="space-y-4">
                {sampleOptionData.depth2Options.map((option) => (
                  <div
                    key={option.id}
                    className="p-5 border-2 border-border rounded-xl hover:border-primary/50 transition-all"
                  >
                    <div className="flex items-start justify-between">
                      {/* ì˜µì…˜ ì •ë³´ */}
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-1">
                          <h3 className="text-lg font-bold text-foreground">
                            {option.name}
                          </h3>
                          <Badge variant="outline" className="text-xs">
                            {option.category}
                          </Badge>
                        </div>
                        {option.description && (
                          <p className="text-sm text-muted-foreground">
                            {option.description}
                          </p>
                        )}
                      </div>

                      {/* ê°€ê²© í‘œì‹œ */}
                      <div className="text-right ml-4">
                        <div
                          className={`text-2xl font-bold ${
                            option.price < 0 ? "text-red-600" : "text-primary"
                          }`}
                        >
                          {option.price < 0 ? "" : "+"}
                          {(option.price / 10000).toLocaleString()}ë§Œì›
                        </div>
                        <p className="text-xs text-muted-foreground mt-1">
                          VAT í¬í•¨
                        </p>
                      </div>
                    </div>
                  </div>
                ))}
              </div>

              {/* ê°€ê²© í‘œì‹œ í˜•ì‹ ì•ˆë‚´ */}
              <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm">
                <p className="font-semibold text-blue-900 mb-2">
                  ğŸ’° ê°€ê²© í‘œì‹œ í˜•ì‹
                </p>
                <ul className="text-blue-800 space-y-1 list-disc list-inside">
                  <li>
                    <strong>ì¶”ê°€ ë¹„ìš©</strong>: +2,000ë§Œì› (íŒŒë€ìƒ‰)
                  </li>
                  <li>
                    <strong>ê¸°ë³¸ í¬í•¨</strong>: 0ì› ë˜ëŠ” "ê¸°ë³¸" í‘œì‹œ
                  </li>
                  <li>
                    <strong>ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜</strong>: -500ë§Œì› (ë¹¨ê°„ìƒ‰)
                  </li>
                </ul>
              </div>
            </div>
          </Wrapper>
        );

      case "M02-8":
        // ì‹¤ì‹œê°„ ì´ì•¡ ê³„ì‚°
        const totalAmount = (() => {
          let total = 0;

          // 1Depth ê°€ê²©
          const depth1Option = sampleOptionData.depth1Options.find(
            (opt) => opt.id === calc1Depth
          );
          if (depth1Option) total += depth1Option.price;

          // 2Depth ê°€ê²©ë“¤
          calc2Depth.forEach((id) => {
            const depth2Option = sampleOptionData.depth2Options.find(
              (opt) => opt.id === id
            );
            if (depth2Option) total += depth2Option.price;
          });

          return total;
        })();

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì‹¤ì‹œê°„ ê¸ˆì•¡ ê³„ì‚°
              </h2>

              {/* 1Depth */}
              <div className="mb-6">
                <h3 className="text-sm font-semibold mb-3">í‰ë©´ íƒ€ì…</h3>
                <div className="flex gap-2">
                  {sampleOptionData.depth1Options.map((option) => (
                    <button
                      key={option.id}
                      onClick={() => setCalc1Depth(option.id)}
                      className={`flex-1 p-3 border-2 rounded-lg font-medium ${
                        calc1Depth === option.id
                          ? "border-primary bg-primary text-white"
                          : "border-border"
                      }`}
                    >
                      {option.name}
                    </button>
                  ))}
                </div>
              </div>

              {/* 2Depth */}
              <div className="mb-6">
                <h3 className="text-sm font-semibold mb-3">ì„¸ë¶€ ì˜µì…˜</h3>
                <div className="space-y-2">
                  {sampleOptionData.depth2Options.slice(0, 4).map((option) => {
                    const isSelected = calc2Depth.includes(option.id);
                    return (
                      <div
                        key={option.id}
                        onClick={() => {
                          if (isSelected) {
                            setCalc2Depth(
                              calc2Depth.filter((id) => id !== option.id)
                            );
                          } else {
                            setCalc2Depth([...calc2Depth, option.id]);
                          }
                        }}
                        className={`p-3 border-2 rounded-lg cursor-pointer flex items-center justify-between ${
                          isSelected
                            ? "border-primary bg-primary/5"
                            : "border-border"
                        }`}
                      >
                        <div className="flex items-center gap-2">
                          <Checkbox checked={isSelected} className="h-4 w-4" />
                          <span className="text-sm font-medium">
                            {option.name}
                          </span>
                        </div>
                        <span
                          className={`text-sm font-bold ${
                            option.price < 0 ? "text-red-600" : "text-primary"
                          }`}
                        >
                          {option.price < 0 ? "" : "+"}
                          {(option.price / 10000).toLocaleString()}ë§Œì›
                        </span>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* ì‹¤ì‹œê°„ ì´ì•¡ í‘œì‹œ (í•˜ë‹¨ ê³ ì •) */}
              <div className="mt-auto pt-6 border-t-2 border-border">
                <div className="flex items-center justify-between p-5 bg-primary/10 rounded-xl">
                  <div>
                    <p className="text-sm text-muted-foreground mb-1">
                      ì„ íƒ ì˜µì…˜ ì´ì•¡
                    </p>
                    <p className="text-xs text-muted-foreground">VAT í¬í•¨</p>
                  </div>
                  <div className="text-right">
                    <div className="text-4xl font-bold text-primary transition-all duration-300">
                      {(totalAmount / 10000).toLocaleString()}
                      <span className="text-xl ml-1">ë§Œì›</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M02-9":
        const handleExclusiveToggle = (optionId: string) => {
          const option = sampleOptionData.depth2Options.find(
            (opt) => opt.id === optionId
          );
          if (!option) return;

          const isSelected = exclusiveSelection.includes(optionId);

          if (isSelected) {
            // ì„ íƒ í•´ì œ
            setExclusiveSelection(
              exclusiveSelection.filter((id) => id !== optionId)
            );
          } else {
            // ì„ íƒ ì‹œ ë°°íƒ€ì  ì˜µì…˜ í™•ì¸
            if (option.excludes) {
              const conflictOption = option.excludes.find((id) =>
                exclusiveSelection.includes(id)
              );
              if (conflictOption) {
                const conflictName = sampleOptionData.depth2Options.find(
                  (opt) => opt.id === conflictOption
                )?.name;
                alert(
                  `"${conflictName}"ì™€ í•¨ê»˜ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € í•´ë‹¹ ì˜µì…˜ì„ í•´ì œí•˜ì„¸ìš”.`
                );
                return;
              }
            }
            setExclusiveSelection([...exclusiveSelection, optionId]);
          }
        };

        // ë°°íƒ€ì  ê´€ê³„ ì˜µì…˜ ì°¾ê¸°
        const exclusiveOptions = sampleOptionData.depth2Options.filter(
          (opt) => opt.excludes
        );

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ë°°íƒ€ì  ì„ íƒ ë¡œì§
              </h2>

              {/* ë°°íƒ€ì  ì˜µì…˜ ì„¤ëª… */}
              <div className="mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg">
                <p className="font-semibold text-purple-900 mb-1">
                  ğŸ”€ ë°°íƒ€ì  ì„ íƒ (Exclusion)
                </p>
                <p className="text-sm text-purple-800">
                  íŠ¹ì • ì˜µì…˜ë“¤ì€ ì„œë¡œ í•¨ê»˜ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì˜ˆ: ëƒ‰ì¥ê³ ì¥ â†”
                  ê¹€ì¹˜ëƒ‰ì¥ê³ ì¥
                </p>
              </div>

              {/* ë°°íƒ€ì  ì˜µì…˜ ê·¸ë£¹ */}
              <div className="space-y-4">
                <div className="p-5 border-2 border-purple-200 rounded-xl bg-purple-50/30">
                  <h3 className="text-sm font-semibold text-foreground mb-3">
                    ëƒ‰ì¥ê³ ì¥ ì„ íƒ (ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì„ íƒ ê°€ëŠ¥)
                  </h3>
                  <div className="space-y-2">
                    {exclusiveOptions.map((option) => {
                      const isSelected = exclusiveSelection.includes(option.id);
                      const isBlocked = option.excludes?.some((id) =>
                        exclusiveSelection.includes(id)
                      );

                      return (
                        <div
                          key={option.id}
                          onClick={() =>
                            !isBlocked && handleExclusiveToggle(option.id)
                          }
                          className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                            isSelected
                              ? "border-primary bg-primary/5"
                              : isBlocked
                              ? "border-red-300 bg-red-50 opacity-60 cursor-not-allowed"
                              : "border-border hover:border-primary/50"
                          }`}
                        >
                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                              <Checkbox
                                checked={isSelected}
                                disabled={isBlocked}
                                className="h-5 w-5"
                              />
                              <div>
                                <p className="font-semibold text-foreground">
                                  {option.name}
                                </p>
                                {isBlocked && (
                                  <p className="text-xs text-red-600 mt-1">
                                    âš ï¸ ë‹¤ë¥¸ ì˜µì…˜ê³¼ í•¨ê»˜ ì„ íƒ ë¶ˆê°€
                                  </p>
                                )}
                              </div>
                            </div>
                            <span className="text-sm font-bold text-primary">
                              +{(option.price / 10000).toLocaleString()}ë§Œì›
                            </span>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>

              {/* ì„ íƒ í˜„í™© */}
              {exclusiveSelection.length > 0 && (
                <div className="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                  <p className="font-semibold text-green-900 mb-2">
                    âœ“ í˜„ì¬ ì„ íƒ
                  </p>
                  <div className="flex flex-wrap gap-2">
                    {exclusiveSelection.map((id) => {
                      const option = sampleOptionData.depth2Options.find(
                        (opt) => opt.id === id
                      );
                      return (
                        <Badge key={id} variant="default" className="px-3 py-1">
                          {option?.name}
                        </Badge>
                      );
                    })}
                  </div>
                </div>
              )}
            </div>
          </Wrapper>
        );

      case "M02-10":
        // ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜ë§Œ í•„í„°ë§
        const minusOptions = sampleOptionData.depth2Options.filter(
          (opt) => opt.price < 0
        );
        const plusOptions = sampleOptionData.depth2Options
          .filter((opt) => opt.price >= 0)
          .slice(0, 3);

        const calculateTotal = () => {
          let total = 0;
          minusSelection.forEach((id) => {
            const option = sampleOptionData.depth2Options.find(
              (opt) => opt.id === id
            );
            if (option) total += option.price;
          });
          return total;
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜ UI
              </h2>

              {/* ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜ ì„¤ëª… */}
              <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                <p className="font-semibold text-red-900 mb-1">
                  ğŸ’¸ ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜
                </p>
                <p className="text-sm text-red-800">
                  ê¸°ë³¸ ì œê³µë˜ëŠ” í’ˆëª©ì„ ì œì™¸í•˜ê³  ê°€ê²©ì„ ì°¨ê°ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
              </div>

              {/* ì¼ë°˜ ì˜µì…˜ */}
              <div className="mb-6">
                <h3 className="text-sm font-semibold mb-3">ì¶”ê°€ ì˜µì…˜</h3>
                <div className="space-y-2">
                  {plusOptions.map((option) => {
                    const isSelected = minusSelection.includes(option.id);
                    return (
                      <div
                        key={option.id}
                        className={`p-4 border-2 rounded-lg ${
                          isSelected
                            ? "border-primary bg-primary/5"
                            : "border-border"
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <span className="font-medium text-foreground">
                            {option.name}
                          </span>
                          <span className="text-sm font-bold text-primary">
                            +{(option.price / 10000).toLocaleString()}ë§Œì›
                          </span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* ë§ˆì´ë„ˆìŠ¤ ì˜µì…˜ */}
              <div className="mb-6">
                <h3 className="text-sm font-semibold mb-3 text-red-600">
                  ì°¨ê° ì˜µì…˜ (ì œì™¸ ì‹œ í• ì¸)
                </h3>
                <div className="space-y-2">
                  {minusOptions.map((option) => {
                    const isSelected = minusSelection.includes(option.id);
                    return (
                      <div
                        key={option.id}
                        onClick={() => {
                          if (isSelected) {
                            setMinusSelection(
                              minusSelection.filter((id) => id !== option.id)
                            );
                          } else {
                            setMinusSelection([...minusSelection, option.id]);
                          }
                        }}
                        className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                          isSelected
                            ? "border-red-500 bg-red-50"
                            : "border-red-200 hover:border-red-400"
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-3">
                            <Checkbox
                              checked={isSelected}
                              className="h-5 w-5"
                            />
                            <div>
                              <div className="flex items-center gap-2">
                                <Badge
                                  variant="destructive"
                                  className="text-xs"
                                >
                                  ë§ˆì´ë„ˆìŠ¤
                                </Badge>
                                <span className="font-semibold text-foreground">
                                  {option.name}
                                </span>
                              </div>
                              {option.description && (
                                <p className="text-xs text-muted-foreground mt-1">
                                  {option.description}
                                </p>
                              )}
                            </div>
                          </div>
                          <span className="text-lg font-bold text-red-600">
                            {(option.price / 10000).toLocaleString()}ë§Œì›
                          </span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* ì´ ì°¨ê° ê¸ˆì•¡ */}
              {minusSelection.length > 0 && (
                <div className="mt-auto pt-6 border-t-2 border-border">
                  <div className="p-5 bg-red-50 border-2 border-red-200 rounded-xl">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="text-sm font-semibold text-red-900">
                          ì°¨ê° ì´ì•¡
                        </p>
                        <p className="text-xs text-red-700 mt-1">
                          {minusSelection.length}ê°œ í’ˆëª© ì œì™¸
                        </p>
                      </div>
                      <div className="text-3xl font-bold text-red-600">
                        {(calculateTotal() / 10000).toLocaleString()}ë§Œì›
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </Wrapper>
        );

      case "M02-11":
        const handleDepToggle = (optionId: string) => {
          // ëª¨ë“  ì˜µì…˜ì„ í•©ì¹œ ë°°ì—´ì—ì„œ ì°¾ìŠµë‹ˆë‹¤.
          const allOptions = [
            ...sampleOptionData.depth2Options,
            ...sampleOptionData.depth3Options,
          ];
          const option = allOptions.find((opt) => opt.id === optionId);

          if (!option) return;

          const isSelected = depSelection.includes(optionId);

          // íƒ€ì…ì„ anyë¡œ ìºìŠ¤íŒ…í•˜ì—¬ ì†ì„± ì¡´ì¬ ì—¬ë¶€ë¥¼ ìœ ì—°í•˜ê²Œ ì²´í¬í•©ë‹ˆë‹¤.
          const optWithReq = option as any;

          if (isSelected) {
            // ì„ íƒ í•´ì œ ì‹œ ì´ ì˜µì…˜ì„ í•„ìš”ë¡œ í•˜ëŠ” ë‹¤ë¥¸ ì˜µì…˜ë„ í•´ì œ
            const dependentOptions = sampleOptionData.depth3Options
              .filter((opt) => (opt as any).requires?.includes(optionId))
              .map((opt) => opt.id);

            setDepSelection(
              depSelection.filter(
                (id) => id !== optionId && !dependentOptions.includes(id)
              )
            );
          } else {
            // ì„ íƒ ì‹œ í•„ìˆ˜ ì˜µì…˜ í™•ì¸ (requires ì†ì„±ì´ ìˆëŠ” ê²½ìš°ë§Œ)
            if (optWithReq.requires && optWithReq.requires.length > 0) {
              const missingRequired = (optWithReq.requires as string[]).filter(
                (reqId) => !depSelection.includes(reqId)
              );
              if (missingRequired.length > 0) {
                const requiredNames = missingRequired
                  .map((id) => {
                    const req = sampleOptionData.depth2Options.find(
                      (o) => o.id === id
                    );
                    return req?.name;
                  })
                  .join(", ");
                alert(`ë¨¼ì € "${requiredNames}"ë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.`);
                return;
              }
            }
            setDepSelection([...depSelection, optionId]);
          }
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                í•„ìˆ˜ ì—°ê´€ ì„ íƒ ê°€ì´ë“œ
              </h2>

              {/* ì„¤ëª… */}
              <div className="mb-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                <p className="font-semibold text-indigo-900 mb-1">
                  ğŸ”— í•„ìˆ˜ ì—°ê´€ (Dependency)
                </p>
                <p className="text-sm text-indigo-800">
                  ì¼ë¶€ ì˜µì…˜ì€ ë‹¤ë¥¸ ì˜µì…˜ì„ ë¨¼ì € ì„ íƒí•´ì•¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                  <br />
                  ì˜ˆ: ì‹ê¸°ì„¸ì²™ê¸° â†’ ì£¼ë°© ê°€êµ¬ì¥ í•„ìˆ˜
                </p>
              </div>

              {/* 2Depth ì˜µì…˜ (ë¶€ëª¨) */}
              <div className="mb-6">
                <h3 className="text-sm font-semibold mb-3">ê¸°ë³¸ ì˜µì…˜</h3>
                <div className="space-y-2">
                  {sampleOptionData.depth2Options.slice(0, 1).map((option) => {
                    const isSelected = depSelection.includes(option.id);
                    return (
                      <div
                        key={option.id}
                        onClick={() => handleDepToggle(option.id)}
                        className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                          isSelected
                            ? "border-primary bg-primary/5"
                            : "border-border hover:border-primary/50"
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-3">
                            <Checkbox
                              checked={isSelected}
                              className="h-5 w-5"
                            />
                            <span className="font-semibold text-foreground">
                              {option.name}
                            </span>
                          </div>
                          <span className="text-sm font-bold text-primary">
                            +{(option.price / 10000).toLocaleString()}ë§Œì›
                          </span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* 3Depth ì˜µì…˜ (ìì‹ - ë¶€ëª¨ í•„ìˆ˜) */}
              <div>
                <h3 className="text-sm font-semibold mb-3">
                  ì—°ê´€ ì˜µì…˜ (ìœ„ ì˜µì…˜ ì„ íƒ í•„ìˆ˜)
                </h3>
                <div className="space-y-2">
                  {sampleOptionData.depth3Options.map((option) => {
                    const isSelected = depSelection.includes(option.id);
                    const isBlocked = option.requires?.some(
                      (reqId) => !depSelection.includes(reqId)
                    );

                    return (
                      <div
                        key={option.id}
                        onClick={() => !isBlocked && handleDepToggle(option.id)}
                        className={`p-4 border-2 rounded-lg cursor-pointer transition-all ${
                          isSelected
                            ? "border-primary bg-primary/5"
                            : isBlocked
                            ? "border-orange-300 bg-orange-50 opacity-60 cursor-not-allowed"
                            : "border-border hover:border-primary/50"
                        }`}
                      >
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-3">
                            <Checkbox
                              checked={isSelected}
                              disabled={isBlocked}
                              className="h-5 w-5"
                            />
                            <div>
                              <p className="font-semibold text-foreground">
                                {option.name}
                              </p>
                              {isBlocked && (
                                <p className="text-xs text-orange-600 mt-1">
                                  âš ï¸ "
                                  {
                                    sampleOptionData.depth2Options.find(
                                      (opt) => opt.id === option.requires?.[0]
                                    )?.name
                                  }
                                  " í•„ìˆ˜ ì„ íƒ
                                </p>
                              )}
                            </div>
                          </div>
                          <span className="text-sm font-bold text-primary">
                            +{(option.price / 10000).toLocaleString()}ë§Œì›
                          </span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* ì—°ê´€ ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨ */}
              <div className="mt-6 p-4 bg-slate-50 border border-slate-200 rounded-lg">
                <p className="font-semibold text-slate-900 mb-3">
                  ğŸ“Š ì—°ê´€ ê´€ê³„
                </p>
                <div className="flex items-center gap-3 text-sm">
                  <Badge variant="secondary">ì£¼ë°© ê°€êµ¬ì¥</Badge>
                  <span className="text-slate-500">â†’</span>
                  <Badge variant="outline">ì‹ê¸°ì„¸ì²™ê¸°</Badge>
                  <Badge variant="outline">ì¸ë•ì…˜ 3êµ¬</Badge>
                </div>
              </div>
            </div>
          </Wrapper>
        );
      case "M03-2":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ìœ„ì¹˜ ë²„íŠ¼ ë„¤ë¹„ê²Œì´ì…˜
              </h2>

              {/* ê³µê°„ ë²„íŠ¼ ê·¸ë¦¬ë“œ */}
              <div className="grid grid-cols-3 gap-3 mb-6">
                {sampleSpaceData.map((space) => {
                  const Icon = space.icon;
                  const isActive = m03_2_currentSpace === space.id;
                  return (
                    <button
                      key={space.id}
                      onClick={() => setM03_2_currentSpace(space.id)}
                      className={`flex flex-col items-center justify-center p-4 rounded-xl border-2 transition-all ${
                        isActive
                          ? "border-primary bg-primary/5 text-primary"
                          : "border-border hover:border-primary/50 text-muted-foreground"
                      }`}
                    >
                      <Icon className="h-6 w-6 mb-2" />
                      <span className="text-sm font-medium">{space.name}</span>
                    </button>
                  );
                })}
              </div>

              {/* ì„ íƒëœ ê³µê°„ ì •ë³´ */}
              <div className="flex-1 bg-muted/20 rounded-xl border-2 border-dashed border-border flex items-center justify-center">
                <div className="text-center">
                  <p className="text-2xl font-bold text-foreground mb-2">
                    {
                      sampleSpaceData.find((s) => s.id === m03_2_currentSpace)
                        ?.name
                    }
                  </p>
                  <p className="text-muted-foreground">
                    3D ë·°ì–´ê°€ ì´ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤
                  </p>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M03-3":
        const handleOptionSelect = (optionName: string) => {
          if (m03_3_isMoving) return;
          setM03_3_selectedOption(optionName);
          setM03_3_isMoving(true);
          setM03_3_targetSpace(optionSpaceMapping[optionName]);

          // ì´ë™ ì‹œë®¬ë ˆì´ì…˜
          setTimeout(() => {
            setM03_3_isMoving(false);
          }, 1500);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì˜µì…˜ ì„ íƒ ì‹œ ìë™ ì´ë™
              </h2>

              {/* ì˜µì…˜ ì„ íƒ */}
              <div className="space-y-3 mb-6">
                <p className="text-sm font-medium text-foreground mb-2">
                  ì˜µì…˜ì„ ì„ íƒí•´ë³´ì„¸ìš”
                </p>
                {Object.keys(optionSpaceMapping).map((option) => (
                  <button
                    key={option}
                    onClick={() => handleOptionSelect(option)}
                    className={`w-full p-4 text-left border-2 rounded-lg transition-all ${
                      m03_3_selectedOption === option
                        ? "border-primary bg-primary/5"
                        : "border-border hover:border-primary/50"
                    }`}
                  >
                    <div className="flex justify-between items-center">
                      <span className="font-semibold">{option}</span>
                      <Badge variant="outline" className="text-xs">
                        {
                          sampleSpaceData.find(
                            (s) => s.id === optionSpaceMapping[option]
                          )?.name
                        }
                      </Badge>
                    </div>
                  </button>
                ))}
              </div>

              {/* ë·°ì–´ ìƒíƒœ */}
              <div className="flex-1 bg-muted/20 rounded-xl border-2 border-dashed border-border flex items-center justify-center relative overflow-hidden">
                {m03_3_isMoving ? (
                  <div className="text-center animate-pulse">
                    <RefreshCw className="h-8 w-8 text-primary mx-auto mb-2 animate-spin" />
                    <p className="font-semibold text-primary">
                      {
                        sampleSpaceData.find((s) => s.id === m03_3_targetSpace)
                          ?.name
                      }
                      (ìœ¼)ë¡œ ì´ë™ ì¤‘...
                    </p>
                  </div>
                ) : m03_3_selectedOption ? (
                  <div className="text-center">
                    <div className="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
                      <Check className="h-8 w-8 text-primary" />
                    </div>
                    <p className="text-lg font-bold text-foreground">
                      {
                        sampleSpaceData.find((s) => s.id === m03_3_targetSpace)
                          ?.name
                      }
                    </p>
                    <p className="text-muted-foreground">ìœ„ì¹˜ë¡œ ì´ë™ ì™„ë£Œ</p>
                  </div>
                ) : (
                  <p className="text-muted-foreground">
                    ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì¹´ë©”ë¼ê°€ ìë™ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤
                  </p>
                )}
              </div>
            </div>
          </Wrapper>
        );

      case "M03-4":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ìœ„ì¹˜ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ
              </h2>

              <div className="space-y-6">
                {highlightAreas.map((area) => {
                  const isHighlighted = m03_4_highlightedAreas.includes(
                    area.id
                  );
                  return (
                    <div
                      key={area.id}
                      className="p-4 border-2 rounded-xl border-border bg-white"
                    >
                      <div className="flex items-center justify-between mb-3">
                        <div className="flex items-center gap-3">
                          <Checkbox
                            checked={isHighlighted}
                            onCheckedChange={(checked) => {
                              if (checked) {
                                setM03_4_highlightedAreas([
                                  ...m03_4_highlightedAreas,
                                  area.id,
                                ]);
                              } else {
                                setM03_4_highlightedAreas(
                                  m03_4_highlightedAreas.filter(
                                    (id) => id !== area.id
                                  )
                                );
                              }
                            }}
                          />
                          <span className="font-semibold">{area.name}</span>
                        </div>
                        <Badge variant="secondary">
                          {
                            sampleSpaceData.find((s) => s.id === area.space)
                              ?.name
                          }
                        </Badge>
                      </div>

                      {/* ì‹œê°ì  í‘œí˜„ */}
                      <div
                        className={`h-24 rounded-lg flex items-center justify-center transition-all ${
                          isHighlighted
                            ? `bg-${area.color}-100 border-2 border-${area.color}-500`
                            : "bg-muted/30 border-2 border-transparent"
                        }`}
                        style={{
                          borderColor: isHighlighted ? area.color : undefined,
                          backgroundColor: isHighlighted
                            ? `var(--${area.color}-100)`
                            : undefined,
                        }}
                      >
                        {isHighlighted ? (
                          <span
                            className="font-bold"
                            style={{ color: area.color }}
                          >
                            âœ¨ í•˜ì´ë¼ì´íŠ¸ ì ìš©ë¨
                          </span>
                        ) : (
                          <span className="text-muted-foreground text-xs">
                            ì„ íƒ ì‹œ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ
                          </span>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          </Wrapper>
        );

      case "M03-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                êµ¬ì¡°ë¬¼ ë™ì  êµì²´
              </h2>

              {/* êµ¬ì¡°ë¬¼ ì„ íƒ */}
              <div className="grid grid-cols-1 gap-3 mb-6">
                {structureTypes.map((type) => (
                  <button
                    key={type.id}
                    onClick={() => setM03_5_structureType(type.id)}
                    className={`p-4 border-2 rounded-xl text-left transition-all ${
                      m03_5_structureType === type.id
                        ? "border-primary bg-primary/5"
                        : "border-border hover:border-primary/50"
                    }`}
                  >
                    <div className="flex justify-between items-center mb-1">
                      <span className="font-bold">{type.name}</span>
                      {m03_5_structureType === type.id && <Badge>ì ìš©ì¤‘</Badge>}
                    </div>
                    <p className="text-xs text-muted-foreground">
                      {type.description}
                    </p>
                  </button>
                ))}
              </div>

              {/* ë·°ì–´ ì‹œë®¬ë ˆì´ì…˜ */}
              <div className="flex-1 bg-slate-900 rounded-xl flex items-center justify-center relative overflow-hidden">
                <div className="text-center text-white">
                  <div className="text-6xl mb-4 transition-all duration-500 transform hover:scale-110">
                    {m03_5_structureType === "basic"
                      ? "ğŸ "
                      : m03_5_structureType === "expanded"
                      ? "ğŸ°"
                      : "ğŸ¢"}
                  </div>
                  <p className="font-mono text-sm opacity-70">
                    Loading model:{" "}
                    {
                      structureTypes.find((t) => t.id === m03_5_structureType)
                        ?.model
                    }
                  </p>
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-1":
      case "M04-3":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <div className="flex items-center justify-between mb-6">
                <h2 className="text-2xl font-bold text-foreground">
                  ê²¬ì ì„œ í™•ì¸
                </h2>
                <button className="text-muted-foreground hover:text-foreground">
                  âœ•
                </button>
              </div>

              <div className="mb-6 pb-4 border-b">
                <p className="text-sm text-muted-foreground">
                  84Aíƒ€ì… | 101ë™ 1001í˜¸
                </p>
              </div>

              <div className="space-y-4 mb-6 flex-1">
                <p className="text-sm font-semibold text-foreground mb-3">
                  [ì„ íƒí•œ ì˜µì…˜]
                </p>

                {[
                  { name: "í”„ë¦¬ë¯¸ì—„ ê°€êµ¬ íŒ¨í‚¤ì§€", price: "+5,000,000ì›" },
                  { name: "ì‹œìŠ¤í…œì—ì–´ì»¨ - ì „ì²´", price: "+2,000,000ì›" },
                  { name: "ì¹¨ì‹¤ ë¶™ë°•ì´ì¥ - 3ê°œì‹¤", price: "+3,000,000ì›" },
                ].map((item, i) => (
                  <div
                    key={i}
                    className="flex justify-between items-center py-3 border-b border-border/50"
                  >
                    <span className="text-sm text-foreground">{item.name}</span>
                    <span className="text-sm font-semibold text-primary">
                      {item.price}
                    </span>
                  </div>
                ))}
              </div>

              <div className="bg-muted/30 rounded-lg p-4 mb-6">
                <div className="flex justify-between items-center">
                  <span className="text-lg font-bold text-foreground">
                    í•©ê³„
                  </span>
                  <span className="text-2xl font-bold text-primary">
                    18,640,000ì›
                  </span>
                </div>
              </div>

              <div className="grid grid-cols-2 gap-3 pb-4">
                <div className="h-12 border-2 border-border rounded-lg flex items-center justify-center text-sm font-semibold text-foreground">
                  ì˜µì…˜ ìˆ˜ì •
                </div>
                <div className="h-12 bg-primary rounded-lg flex items-center justify-center text-sm font-semibold text-white">
                  ê²¬ì  í™•ì¸í•˜ê¸°
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-2":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì˜µì…˜ ìš”ì•½ í‘œì‹œ
              </h2>

              <div className="flex-1 space-y-4">
                {selectedOptionsSummary.map((item, i) => (
                  <div
                    key={i}
                    className="flex items-center justify-between p-4 border-2 border-border rounded-xl bg-white"
                  >
                    <div className="flex items-center gap-3">
                      <div className="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center text-primary font-bold">
                        {i + 1}
                      </div>
                      <div>
                        <p className="font-semibold text-foreground">
                          {item.name}
                        </p>
                        <Badge variant="outline" className="text-xs">
                          {item.category}
                        </Badge>
                      </div>
                    </div>
                    <div className="text-right">
                      <p className="font-bold text-primary">
                        +{(item.price / 10000).toLocaleString()}ë§Œì›
                      </p>
                      <button className="text-xs text-red-500 hover:underline">
                        ì œê±°
                      </button>
                    </div>
                  </div>
                ))}
              </div>

              <div className="mt-6 p-5 bg-slate-900 text-white rounded-xl shadow-lg">
                <div className="flex justify-between items-center mb-2">
                  <span className="opacity-70">
                    ì´ {selectedOptionsSummary.length}ê°œ ì˜µì…˜
                  </span>
                  <span className="text-2xl font-bold">
                    {(
                      selectedOptionsSummary.reduce(
                        (acc, cur) => acc + cur.price,
                        0
                      ) / 10000
                    ).toLocaleString()}
                    ë§Œì›
                  </span>
                </div>
                <button className="w-full py-3 bg-white text-slate-900 rounded-lg font-bold hover:bg-slate-100 transition-colors">
                  ê²¬ì ì„œ ë³´ê¸°
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-4":
        const handleOptionEdit = (index: number) => {
          setM04_4_isEditing(true);
          // ì‹¤ì œë¡œëŠ” ì—¬ê¸°ì„œ ëª¨ë‹¬ì´ë‚˜ ë“œë¡­ë‹¤ìš´ì„ ë„ì›Œ ë³€ê²½
          const newOptions = [...m04_4_quoteOptions];
          if (newOptions[index].name.includes("(ìˆ˜ì •ë¨)")) {
            newOptions[index].name = newOptions[index].name.replace(
              " (ìˆ˜ì •ë¨)",
              ""
            );
          } else {
            newOptions[index].name += " (ìˆ˜ì •ë¨)";
          }
          setM04_4_quoteOptions(newOptions);
          setTimeout(() => setM04_4_isEditing(false), 500);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ê²¬ì ì„œ ë‚´ ì˜µì…˜ ìˆ˜ì •
              </h2>

              <div className="flex-1 bg-white border-2 border-border rounded-xl p-6 shadow-sm">
                <div className="border-b-2 border-border pb-4 mb-4 flex justify-between items-center">
                  <h3 className="font-bold text-lg">ìµœì¢… ê²¬ì ì„œ</h3>
                  <span className="text-sm text-muted-foreground">
                    No. 2024-001
                  </span>
                </div>

                <div className="space-y-4">
                  {m04_4_quoteOptions.map((item, i) => (
                    <div
                      key={i}
                      className="flex items-center justify-between py-2 border-b border-dashed border-border/50"
                    >
                      <div>
                        <p className="font-medium">{item.name}</p>
                        <p className="text-xs text-muted-foreground">
                          {item.category}
                        </p>
                      </div>
                      <div className="flex items-center gap-3">
                        <span className="font-bold">
                          {(item.price / 10000).toLocaleString()}ë§Œì›
                        </span>
                        <button
                          onClick={() => handleOptionEdit(i)}
                          className="p-1 hover:bg-muted rounded text-primary"
                          title="ì˜µì…˜ ìˆ˜ì •"
                        >
                          {m04_4_isEditing ? (
                            <RefreshCw className="h-4 w-4 animate-spin" />
                          ) : (
                            <FileText className="h-4 w-4" />
                          )}
                        </button>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="mt-8 pt-4 border-t-2 border-border flex justify-between items-center">
                  <span className="font-bold text-lg">ìµœì¢… í•©ê³„</span>
                  <span className="font-bold text-2xl text-primary">
                    {(
                      m04_4_quoteOptions.reduce(
                        (acc, cur) => acc + cur.price,
                        0
                      ) / 10000
                    ).toLocaleString()}
                    ë§Œì›
                  </span>
                </div>
              </div>

              <div className="mt-4 flex gap-3">
                <button className="flex-1 py-3 border-2 border-border rounded-lg font-semibold hover:bg-muted transition-colors">
                  ìˆ˜ì • ì·¨ì†Œ
                </button>
                <button className="flex-1 py-3 bg-primary text-white rounded-lg font-semibold hover:bg-primary/90 transition-colors">
                  ìˆ˜ì • ì™„ë£Œ
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ë‹¤ìŒ/ì´ì „ ë²„íŠ¼
              </h2>

              {/* ì§„í–‰ ìƒíƒœ ë°” */}
              <div className="mb-8">
                <div className="flex justify-between text-xs text-muted-foreground mb-2">
                  <span>ì§„í–‰ë¥ </span>
                  <span>
                    {m04_5_currentCategory + 1} / {optionCategories.length}
                  </span>
                </div>
                <div className="h-2 bg-muted rounded-full overflow-hidden">
                  <div
                    className="h-full bg-primary transition-all duration-300"
                    style={{
                      width: `${
                        ((m04_5_currentCategory + 1) /
                          optionCategories.length) *
                        100
                      }%`,
                    }}
                  />
                </div>
              </div>

              {/* í˜„ì¬ ë‹¨ê³„ ì»¨í…ì¸  */}
              <div className="flex-1 flex items-center justify-center p-8 bg-muted/20 border-2 border-dashed border-border rounded-xl mb-8">
                <div className="text-center">
                  <h3 className="text-2xl font-bold text-foreground mb-2">
                    {optionCategories[m04_5_currentCategory].name}
                  </h3>
                  <p className="text-muted-foreground">
                    {optionCategories[m04_5_currentCategory].description}
                  </p>
                </div>
              </div>

              {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */}
              <div className="flex gap-4">
                <button
                  onClick={() =>
                    setM04_5_currentCategory(
                      Math.max(0, m04_5_currentCategory - 1)
                    )
                  }
                  disabled={m04_5_currentCategory === 0}
                  className={`flex-1 h-14 flex items-center justify-center gap-2 rounded-lg font-semibold border-2 transition-all ${
                    m04_5_currentCategory === 0
                      ? "border-muted text-muted-foreground cursor-not-allowed opacity-50"
                      : "border-border hover:bg-muted text-foreground"
                  }`}
                >
                  <ArrowLeft className="h-5 w-5" />
                  ì´ì „ ë‹¨ê³„
                </button>

                <button
                  onClick={() =>
                    setM04_5_currentCategory(
                      Math.min(
                        optionCategories.length - 1,
                        m04_5_currentCategory + 1
                      )
                    )
                  }
                  className="flex-1 h-14 bg-primary text-white rounded-lg font-semibold flex items-center justify-center gap-2 hover:bg-primary/90 transition-all shadow-lg hover:shadow-xl"
                >
                  {m04_5_currentCategory === optionCategories.length - 1
                    ? "ê²¬ì ì„œ ë³´ê¸°"
                    : "ë‹¤ìŒ ë‹¨ê³„"}
                  <ArrowRight className="h-5 w-5" />
                </button>
              </div>
            </div>
          </Wrapper>
        );
      case "M04-2":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì˜µì…˜ ìš”ì•½ í‘œì‹œ
              </h2>

              <div className="flex-1 space-y-4">
                {selectedOptionsSummary.map((item, i) => (
                  <div
                    key={i}
                    className="flex items-center justify-between p-4 border-2 border-border rounded-xl bg-white"
                  >
                    <div className="flex items-center gap-3">
                      <div className="w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center text-primary font-bold">
                        {i + 1}
                      </div>
                      <div>
                        <p className="font-semibold text-foreground">
                          {item.name}
                        </p>
                        <Badge variant="outline" className="text-xs">
                          {item.category}
                        </Badge>
                      </div>
                    </div>
                    <div className="text-right">
                      <p className="font-bold text-primary">
                        +{(item.price / 10000).toLocaleString()}ë§Œì›
                      </p>
                      <button className="text-xs text-red-500 hover:underline">
                        ì œê±°
                      </button>
                    </div>
                  </div>
                ))}
              </div>

              <div className="mt-6 p-5 bg-slate-900 text-white rounded-xl shadow-lg">
                <div className="flex justify-between items-center mb-2">
                  <span className="opacity-70">
                    ì´ {selectedOptionsSummary.length}ê°œ ì˜µì…˜
                  </span>
                  <span className="text-2xl font-bold">
                    {(
                      selectedOptionsSummary.reduce(
                        (acc, cur) => acc + cur.price,
                        0
                      ) / 10000
                    ).toLocaleString()}
                    ë§Œì›
                  </span>
                </div>
                <button className="w-full py-3 bg-white text-slate-900 rounded-lg font-bold hover:bg-slate-100 transition-colors">
                  ê²¬ì ì„œ ë³´ê¸°
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-4":
        const handleOptionEdit = (index: number) => {
          setM04_4_isEditing(true);
          // ì‹¤ì œë¡œëŠ” ì—¬ê¸°ì„œ ëª¨ë‹¬ì´ë‚˜ ë“œë¡­ë‹¤ìš´ì„ ë„ì›Œ ë³€ê²½
          const newOptions = [...m04_4_quoteOptions];
          if (newOptions[index].name.includes("(ìˆ˜ì •ë¨)")) {
            newOptions[index].name = newOptions[index].name.replace(
              " (ìˆ˜ì •ë¨)",
              ""
            );
          } else {
            newOptions[index].name += " (ìˆ˜ì •ë¨)";
          }
          setM04_4_quoteOptions(newOptions);
          setTimeout(() => setM04_4_isEditing(false), 500);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ê²¬ì ì„œ ë‚´ ì˜µì…˜ ìˆ˜ì •
              </h2>

              <div className="flex-1 bg-white border-2 border-border rounded-xl p-6 shadow-sm">
                <div className="border-b-2 border-border pb-4 mb-4 flex justify-between items-center">
                  <h3 className="font-bold text-lg">ìµœì¢… ê²¬ì ì„œ</h3>
                  <span className="text-sm text-muted-foreground">
                    No. 2024-001
                  </span>
                </div>

                <div className="space-y-4">
                  {m04_4_quoteOptions.map((item, i) => (
                    <div
                      key={i}
                      className="flex items-center justify-between py-2 border-b border-dashed border-border/50"
                    >
                      <div>
                        <p className="font-medium">{item.name}</p>
                        <p className="text-xs text-muted-foreground">
                          {item.category}
                        </p>
                      </div>
                      <div className="flex items-center gap-3">
                        <span className="font-bold">
                          {(item.price / 10000).toLocaleString()}ë§Œì›
                        </span>
                        <button
                          onClick={() => handleOptionEdit(i)}
                          className="p-1 hover:bg-muted rounded text-primary"
                          title="ì˜µì…˜ ìˆ˜ì •"
                        >
                          {m04_4_isEditing ? (
                            <RefreshCw className="h-4 w-4 animate-spin" />
                          ) : (
                            <FileText className="h-4 w-4" />
                          )}
                        </button>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="mt-8 pt-4 border-t-2 border-border flex justify-between items-center">
                  <span className="font-bold text-lg">ìµœì¢… í•©ê³„</span>
                  <span className="font-bold text-2xl text-primary">
                    {(
                      m04_4_quoteOptions.reduce(
                        (acc, cur) => acc + cur.price,
                        0
                      ) / 10000
                    ).toLocaleString()}
                    ë§Œì›
                  </span>
                </div>
              </div>

              <div className="mt-4 flex gap-3">
                <button className="flex-1 py-3 border-2 border-border rounded-lg font-semibold hover:bg-muted transition-colors">
                  ìˆ˜ì • ì·¨ì†Œ
                </button>
                <button className="flex-1 py-3 bg-primary text-white rounded-lg font-semibold hover:bg-primary/90 transition-colors">
                  ìˆ˜ì • ì™„ë£Œ
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ë‹¤ìŒ/ì´ì „ ë²„íŠ¼
              </h2>

              {/* ì§„í–‰ ìƒíƒœ ë°” */}
              <div className="mb-8">
                <div className="flex justify-between text-xs text-muted-foreground mb-2">
                  <span>ì§„í–‰ë¥ </span>
                  <span>
                    {m04_5_currentCategory + 1} / {optionCategories.length}
                  </span>
                </div>
                <div className="h-2 bg-muted rounded-full overflow-hidden">
                  <div
                    className="h-full bg-primary transition-all duration-300"
                    style={{
                      width: `${
                        ((m04_5_currentCategory + 1) /
                          optionCategories.length) *
                        100
                      }%`,
                    }}
                  />
                </div>
              </div>

              {/* í˜„ì¬ ë‹¨ê³„ ì»¨í…ì¸  */}
              <div className="flex-1 flex items-center justify-center p-8 bg-muted/20 border-2 border-dashed border-border rounded-xl mb-8">
                <div className="text-center">
                  <h3 className="text-2xl font-bold text-foreground mb-2">
                    {optionCategories[m04_5_currentCategory].name}
                  </h3>
                  <p className="text-muted-foreground">
                    {optionCategories[m04_5_currentCategory].description}
                  </p>
                </div>
              </div>

              {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */}
              <div className="flex gap-4">
                <button
                  onClick={() =>
                    setM04_5_currentCategory(
                      Math.max(0, m04_5_currentCategory - 1)
                    )
                  }
                  disabled={m04_5_currentCategory === 0}
                  className={`flex-1 h-14 flex items-center justify-center gap-2 rounded-lg font-semibold border-2 transition-all ${
                    m04_5_currentCategory === 0
                      ? "border-muted text-muted-foreground cursor-not-allowed opacity-50"
                      : "border-border hover:bg-muted text-foreground"
                  }`}
                >
                  <ArrowLeft className="h-5 w-5" />
                  ì´ì „ ë‹¨ê³„
                </button>

                <button
                  onClick={() =>
                    setM04_5_currentCategory(
                      Math.min(
                        optionCategories.length - 1,
                        m04_5_currentCategory + 1
                      )
                    )
                  }
                  className="flex-1 h-14 bg-primary text-white rounded-lg font-semibold flex items-center justify-center gap-2 hover:bg-primary/90 transition-all shadow-lg hover:shadow-xl"
                >
                  {m04_5_currentCategory === optionCategories.length - 1
                    ? "ê²¬ì ì„œ ë³´ê¸°"
                    : "ë‹¤ìŒ ë‹¨ê³„"}
                  <ArrowRight className="h-5 w-5" />
                </button>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-6":
        return (
          <Wrapper>
            <div className="flex items-center justify-center h-full p-8">
              <div className="text-center">
                <div className="w-24 h-24 bg-red-100 rounded-full mx-auto mb-6 flex items-center justify-center">
                  <Download className="h-12 w-12 text-red-600" />
                </div>
                <h2 className="text-2xl font-bold text-foreground mb-4">
                  PDF ë‹¤ìš´ë¡œë“œ
                </h2>
                <p className="text-muted-foreground mb-8">
                  ê²¬ì ì„œë¥¼ PDF íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤
                </p>
                <div className="h-14 bg-red-600 rounded-lg flex items-center justify-center text-white font-semibold cursor-pointer hover:bg-red-700 transition-colors px-8">
                  <Download className="h-5 w-5 mr-2" />
                  PDF ë‹¤ìš´ë¡œë“œ
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M04-7":
        return (
          <Wrapper>
            <div className="flex items-center justify-center h-full p-8">
              <div className="text-center">
                <div className="w-24 h-24 bg-green-100 rounded-full mx-auto mb-6 flex items-center justify-center">
                  <Download className="h-12 w-12 text-green-600" />
                </div>
                <h2 className="text-2xl font-bold text-foreground mb-4">
                  Excel ë‹¤ìš´ë¡œë“œ
                </h2>
                <p className="text-muted-foreground mb-8">
                  ê²¬ì ì„œë¥¼ Excel íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤
                </p>
                <div className="h-14 bg-green-600 rounded-lg flex items-center justify-center text-white font-semibold cursor-pointer hover:bg-green-700 transition-colors px-8">
                  <Download className="h-5 w-5 mr-2" />
                  Excel ë‹¤ìš´ë¡œë“œ
                </div>
              </div>
            </div>
          </Wrapper>
        );

      case "M05-1":
        return (
          <Wrapper>
            <div className="flex items-center justify-center h-full p-8">
              <div className="w-full max-w-md">
                <h2 className="text-2xl font-bold text-foreground mb-6 text-center">
                  êµ¬ê¸€ ì‹œíŠ¸ ì—°ë™
                </h2>
                <div className="space-y-4">
                  <div className="bg-green-50 border-2 border-green-500 rounded-lg p-4">
                    <p className="text-sm font-semibold text-green-900 mb-2">
                      âœ“ ì—°ë™ ì™„ë£Œ
                    </p>
                    <p className="text-xs text-green-700">
                      ë°ì´í„°ê°€ êµ¬ê¸€ ì‹œíŠ¸ì— ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤
                    </p>
                  </div>
                  <div className="border-2 border-border rounded-lg p-4">
                    <p className="text-sm font-medium text-foreground mb-2">
                      ì‹œíŠ¸ ì •ë³´
                    </p>
                    <p className="text-xs text-muted-foreground">
                      ë¬¸ì„œëª…: ì˜µì…˜_ì„ íƒ_ë°ì´í„°_2024
                    </p>
                    <p className="text-xs text-muted-foreground">
                      ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2024-01-15
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        );
      case "M05-2":
        const handleSaveToDB = () => {
          setM05_2_isSaving(true);
          setTimeout(() => {
            setM05_2_isSaving(false);
            setM05_2_saveResult({
              id: "QUOTE-2024-001",
              timestamp: new Date().toLocaleString(),
              size: "2.4KB",
            });
          }, 2000);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ìì²´ DB ì €ì¥
              </h2>

              <div className="flex-1 flex flex-col items-center justify-center space-y-6">
                <div className="w-full max-w-sm p-4 bg-slate-900 rounded-lg font-mono text-xs text-green-400 overflow-hidden shadow-lg">
                  <div className="flex gap-1.5 mb-3">
                    <div className="w-2.5 h-2.5 rounded-full bg-red-500"></div>
                    <div className="w-2.5 h-2.5 rounded-full bg-yellow-500"></div>
                    <div className="w-2.5 h-2.5 rounded-full bg-green-500"></div>
                  </div>
                  <pre>
                    {JSON.stringify(
                      {
                        user: "hong_gildong",
                        options: ["opt1-1", "opt2-1", "opt3-1"],
                        total: 7500000,
                        version: "1.0.0",
                      },
                      null,
                      2
                    )}
                  </pre>
                </div>

                {m05_2_saveResult ? (
                  <div className="w-full max-w-sm p-4 bg-green-50 border-2 border-green-200 rounded-xl text-center animate-in fade-in slide-in-from-bottom-4">
                    <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                      <Check className="h-6 w-6 text-green-600" />
                    </div>
                    <p className="font-bold text-green-900 mb-1">ì €ì¥ ì™„ë£Œ</p>
                    <p className="text-sm text-green-800 mb-2">
                      ë°ì´í„°ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
                    </p>
                    <div className="text-xs text-green-700 bg-green-100/50 p-2 rounded">
                      ID: {m05_2_saveResult.id}
                      <br />
                      Time: {m05_2_saveResult.timestamp}
                    </div>
                  </div>
                ) : (
                  <button
                    onClick={handleSaveToDB}
                    disabled={m05_2_isSaving}
                    className="w-full max-w-sm h-14 bg-primary text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-primary/90 transition-all shadow-lg hover:shadow-xl disabled:opacity-70"
                  >
                    {m05_2_isSaving ? (
                      <>
                        <RefreshCw className="h-5 w-5 animate-spin" />
                        ì €ì¥ ì¤‘...
                      </>
                    ) : (
                      <>
                        <DatabaseIcon className="h-5 w-5" />
                        ìì²´ DBì— ì €ì¥
                      </>
                    )}
                  </button>
                )}
              </div>
            </div>
          </Wrapper>
        );

      case "M05-3":
        const handleSendToAPI = () => {
          setM05_3_isSending(true);
          setTimeout(() => {
            setM05_3_isSending(false);
            setM05_3_sendResult({
              status: 200,
              message: "OK",
              timestamp: new Date().toLocaleTimeString(),
            });
          }, 2000);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ê±´ì„¤ì‚¬ API ì „ì†¡
              </h2>

              <div className="flex-1 flex flex-col">
                <div className="mb-6 p-4 bg-slate-50 border-2 border-slate-200 rounded-xl">
                  <div className="flex items-center justify-between mb-2">
                    <span className="font-bold text-sm text-slate-700">
                      API ENDPOINT
                    </span>
                    <Badge
                      variant="outline"
                      className="bg-green-50 text-green-700 border-green-200"
                    >
                      POST
                    </Badge>
                  </div>
                  <code className="text-xs bg-white p-2 rounded border block text-slate-600">
                    https://api.construction-company.com/v1/options/submit
                  </code>
                </div>

                <div className="flex-1 flex items-center justify-center">
                  {m05_3_sendResult ? (
                    <div className="text-center animate-in zoom-in-50">
                      <div className="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 relative">
                        <Upload className="h-10 w-10 text-blue-600" />
                        <div className="absolute -top-1 -right-1 w-8 h-8 bg-green-500 rounded-full flex items-center justify-center border-4 border-white">
                          <Check
                            className="h-4 w-4 text-white"
                            strokeWidth={4}
                          />
                        </div>
                      </div>
                      <h3 className="text-2xl font-bold text-slate-900 mb-2">
                        ì „ì†¡ ì™„ë£Œ
                      </h3>
                      <p className="text-slate-500 mb-4">
                        ê±´ì„¤ì‚¬ ì‹œìŠ¤í…œìœ¼ë¡œ ë°ì´í„°ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.
                      </p>
                      <div className="inline-flex items-center gap-2 px-4 py-2 bg-slate-100 rounded-full text-sm font-mono text-slate-600">
                        <span>Status: {m05_3_sendResult.status}</span>
                        <span className="w-1 h-4 bg-slate-300"></span>
                        <span>Time: {m05_3_sendResult.timestamp}</span>
                      </div>
                    </div>
                  ) : (
                    <div className="text-center opacity-50">
                      <Upload className="h-16 w-16 mx-auto mb-4 text-slate-300" />
                      <p>ì „ì†¡ ëŒ€ê¸° ì¤‘</p>
                    </div>
                  )}
                </div>

                {!m05_3_sendResult && (
                  <button
                    onClick={handleSendToAPI}
                    disabled={m05_3_isSending}
                    className="w-full h-14 bg-slate-900 text-white rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-slate-800 transition-all shadow-lg mt-6 disabled:opacity-70"
                  >
                    {m05_3_isSending ? (
                      <>
                        <RefreshCw className="h-5 w-5 animate-spin" />
                        ì „ì†¡ ì¤‘...
                      </>
                    ) : (
                      <>
                        <Upload className="h-5 w-5" />
                        ê±´ì„¤ì‚¬ APIë¡œ ì „ì†¡
                      </>
                    )}
                  </button>
                )}
              </div>
            </div>
          </Wrapper>
        );

      case "M05-4":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                NíšŒ ì œì¶œ í—ˆìš©
              </h2>

              <div className="mb-8 text-center">
                <div className="inline-block p-4 rounded-full bg-slate-100 mb-4 relative">
                  <div className="text-4xl font-black text-slate-900 w-16 h-16 flex items-center justify-center">
                    {m05_4_submitCount}
                  </div>
                  <div className="absolute -top-2 -right-2 bg-primary text-white text-xs font-bold px-2 py-1 rounded-full">
                    Max {m05_4_maxSubmits}
                  </div>
                </div>
                <p className="font-medium text-slate-600">í˜„ì¬ ì œì¶œ íšŸìˆ˜</p>
              </div>

              <div className="flex-1">
                <h3 className="text-sm font-bold text-muted-foreground mb-3 uppercase tracking-wider">
                  ì œì¶œ ì´ë ¥
                </h3>
                <div className="space-y-3">
                  {Array.from({ length: Math.min(3, m05_4_submitCount) }).map(
                    (_, i) => (
                      <div
                        key={i}
                        className="flex items-center justify-between p-4 bg-white border border-border rounded-xl shadow-sm"
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-bold text-sm">
                            #{m05_4_submitCount - i}
                          </div>
                          <div>
                            <p className="font-bold text-sm">
                              ê²¬ì ì„œ ì œì¶œ ì™„ë£Œ
                            </p>
                            <p className="text-xs text-muted-foreground">
                              2024.02.0{5 - i} 14:30
                            </p>
                          </div>
                        </div>
                        <Badge variant="outline">ì„±ê³µ</Badge>
                      </div>
                    )
                  )}
                  {m05_4_submitCount === 0 && (
                    <div className="text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-border rounded-xl">
                      ì œì¶œ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.
                    </div>
                  )}
                </div>
              </div>

              <div className="mt-6">
                {m05_4_submitCount >= m05_4_maxSubmits ? (
                  <div className="p-4 bg-red-50 border-2 border-red-200 rounded-xl flex items-center gap-3 text-red-800">
                    <AlertCircle className="h-5 w-5 flex-shrink-0" />
                    <p className="text-sm font-medium">
                      ì œì¶œ í•œë„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (ìµœëŒ€ {m05_4_maxSubmits}íšŒ)
                    </p>
                  </div>
                ) : (
                  <button
                    onClick={() => setM05_4_submitCount((prev) => prev + 1)}
                    className="w-full h-14 bg-primary text-white rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg"
                  >
                    ê²¬ì ì„œ ì œì¶œí•˜ê¸° ({m05_4_maxSubmits - m05_4_submitCount}íšŒ
                    ë‚¨ìŒ)
                  </button>
                )}
              </div>
            </div>
          </Wrapper>
        );

      case "M05-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                1íšŒ ì œì¶œ ì œí•œ
              </h2>

              <div className="flex-1 flex flex-col items-center justify-center text-center">
                {m05_5_hasSubmitted ? (
                  <div className="animate-in zoom-in-50">
                    <div className="w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6 relative">
                      <FileText className="h-10 w-10 text-slate-400" />
                      <div className="absolute -bottom-2 -right-2 bg-green-500 text-white p-2 rounded-full border-4 border-white">
                        <Check className="h-5 w-5" strokeWidth={4} />
                      </div>
                    </div>
                    <h3 className="text-2xl font-bold text-slate-900 mb-2">
                      ì œì¶œ ì™„ë£Œë¨
                    </h3>
                    <p className="text-slate-500 max-w-xs mx-auto mb-6">
                      ì´ë¯¸ ê²¬ì ì„œë¥¼ ì œì¶œí•˜ì…¨ìŠµë‹ˆë‹¤. <br />
                      ì¶”ê°€ ì œì¶œì´ë‚˜ ìˆ˜ì •ì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </p>
                    <div className="p-4 bg-slate-50 rounded-xl border border-slate-200 inline-block text-left min-w-[280px]">
                      <div className="flex justify-between text-sm mb-2">
                        <span className="text-slate-500">ì œì¶œë²ˆí˜¸</span>
                        <span className="font-mono font-bold">
                          REQ-2024-001
                        </span>
                      </div>
                      <div className="flex justify-between text-sm">
                        <span className="text-slate-500">ì œì¶œì‹œê°</span>
                        <span className="font-medium">2024.02.05 15:42</span>
                      </div>
                    </div>
                  </div>
                ) : (
                  <div>
                    <div className="w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse">
                      <FileText className="h-10 w-10 text-primary" />
                    </div>
                    <h3 className="text-2xl font-bold text-foreground mb-2">
                      ê²¬ì ì„œ ì œì¶œ
                    </h3>
                    <p className="text-muted-foreground max-w-xs mx-auto mb-8">
                      ìµœì¢… ê²¬ì ì„œë¥¼ ì œì¶œí•©ë‹ˆë‹¤. <br />
                      <span className="text-red-500 font-bold">
                        ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥
                      </span>
                      í•˜ë‹ˆ ì‹ ì¤‘í•˜ê²Œ ê²°ì •í•´ì£¼ì„¸ìš”.
                    </p>
                    <button
                      onClick={() => setM05_5_hasSubmitted(true)}
                      className="w-full max-w-xs h-14 bg-primary text-white rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg"
                    >
                      ìµœì¢… ì œì¶œí•˜ê¸° (1íšŒ í•œì •)
                    </button>
                  </div>
                )}
              </div>
            </div>
          </Wrapper>
        );

      case "M05-6":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì œì¶œ ì´ë ¥ ê´€ë¦¬
              </h2>

              <div className="flex-1">
                {/* í•„í„° */}
                <div className="flex gap-2 mb-4 overflow-x-auto pb-2">
                  <button className="px-4 py-2 bg-slate-900 text-white rounded-full text-xs font-bold whitespace-nowrap">
                    ì „ì²´
                  </button>
                  <button className="px-4 py-2 bg-white border border-border text-slate-600 rounded-full text-xs font-medium whitespace-nowrap hover:bg-slate-50">
                    ì´ë²ˆì£¼
                  </button>
                  <button className="px-4 py-2 bg-white border border-border text-slate-600 rounded-full text-xs font-medium whitespace-nowrap hover:bg-slate-50">
                    ì œì¶œì™„ë£Œ
                  </button>
                  <button className="px-4 py-2 bg-white border border-border text-slate-600 rounded-full text-xs font-medium whitespace-nowrap hover:bg-slate-50">
                    ì„ì‹œì €ì¥
                  </button>
                </div>

                {/* ì´ë ¥ ë¦¬ìŠ¤íŠ¸ */}
                <div className="space-y-3">
                  {m05_6_history.map((item, i) => (
                    <div
                      key={i}
                      className="group p-4 bg-white border border-border rounded-xl hover:border-primary/50 hover:shadow-md transition-all cursor-pointer"
                    >
                      <div className="flex justify-between items-start mb-3">
                        <div className="flex items-center gap-2">
                          <FileText className="h-4 w-4 text-slate-400" />
                          <span className="font-mono text-xs font-bold text-slate-700">
                            {item.id}
                          </span>
                        </div>
                        <Badge
                          variant={
                            item.status === "ì œì¶œì™„ë£Œ" ? "default" : "secondary"
                          }
                          className="text-[10px]"
                        >
                          {item.status}
                        </Badge>
                      </div>
                      <div className="flex justify-between items-end">
                        <div>
                          <p className="text-xs text-muted-foreground mb-1">
                            ì´ ê²¬ì  ê¸ˆì•¡
                          </p>
                          <p className="font-bold text-lg">
                            {(item.total / 10000).toLocaleString()}ë§Œì›
                          </p>
                        </div>
                        <div className="text-right">
                          <div className="flex items-center gap-1 text-xs text-muted-foreground">
                            <Clock className="h-3 w-3" />
                            {item.date}
                          </div>
                        </div>
                      </div>

                      <div className="mt-3 pt-3 border-t border-dashed border-border flex justify-end opacity-0 group-hover:opacity-100 transition-opacity">
                        <button className="text-xs font-bold text-primary hover:underline flex items-center gap-1">
                          ìƒì„¸ë³´ê¸° <ChevronRight className="h-3 w-3" />
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
              <div className="mt-4 flex justify-center gap-2">
                {[1, 2, 3].map((p) => (
                  <button
                    key={p}
                    className={`w-8 h-8 rounded-lg text-xs font-bold flex items-center justify-center ${
                      p === 1
                        ? "bg-slate-900 text-white"
                        : "bg-transparent hover:bg-slate-100 text-slate-600"
                    }`}
                  >
                    {p}
                  </button>
                ))}
              </div>
            </div>
          </Wrapper>
        );

      case "M05-7":
        const handleConfirmSubmit = () => {
          setM05_7_showConfirm(true);
        };

        const handleFinalSubmit = () => {
          setM05_7_isSubmitting(true);
          setTimeout(() => {
            setM05_7_isSubmitting(false);
            setM05_7_showConfirm(false);
            alert("ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
          }, 2000);
        };

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6 relative">
              <h2 className="text-xl font-bold text-foreground mb-6">
                ì œì¶œ í™•ì¸ íŒì—…
              </h2>

              <div className="flex-1 flex items-center justify-center">
                <button
                  onClick={handleConfirmSubmit}
                  className="px-8 py-4 bg-primary text-white rounded-xl font-bold text-lg shadow-xl hover:bg-primary/90 hover:scale-105 transition-all"
                >
                  ê²¬ì ì„œ ì œì¶œí•˜ê¸°
                </button>
              </div>

              {/* Confirmation Popup Overlay */}
              {m05_7_showConfirm && (
                <div className="absolute inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200">
                  <div className="bg-white w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200">
                    <div className="p-6 text-center">
                      <div className="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <AlertCircle className="h-8 w-8 text-yellow-600" />
                      </div>
                      <h3 className="text-xl font-bold text-slate-900 mb-2">
                        ì •ë§ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                      </h3>
                      <p className="text-sm text-slate-500 mb-6">
                        ì œì¶œ í›„ì—ëŠ” ì˜µì…˜ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                        <br />
                        ì…ë ¥í•˜ì‹  ë‚´ìš©ì„ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•´ì£¼ì„¸ìš”.
                      </p>

                      <div className="bg-slate-50 rounded-xl p-4 mb-6 text-left text-sm border border-slate-100">
                        <div className="flex justify-between mb-2">
                          <span className="text-slate-500">ì„ íƒ ì˜µì…˜</span>
                          <span className="font-bold">4ê°œ</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-slate-500">ì´ ê¸ˆì•¡</span>
                          <span className="font-bold text-primary">
                            830ë§Œì›
                          </span>
                        </div>
                      </div>

                      <div className="flex gap-3">
                        <button
                          onClick={() => setM05_7_showConfirm(false)}
                          disabled={m05_7_isSubmitting}
                          className="flex-1 py-3 bg-white border-2 border-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-50 transition-colors disabled:opacity-50"
                        >
                          ì·¨ì†Œ
                        </button>
                        <button
                          onClick={handleFinalSubmit}
                          disabled={m05_7_isSubmitting}
                          className="flex-1 py-3 bg-primary text-white rounded-xl font-bold hover:bg-primary/90 transition-colors flex items-center justify-center gap-2 disabled:opacity-50"
                        >
                          {m05_7_isSubmitting ? (
                            <>
                              <RefreshCw className="h-4 w-4 animate-spin" />
                              ì²˜ë¦¬ì¤‘
                            </>
                          ) : (
                            "í™•ì¸"
                          )}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </Wrapper>
        )

      case "M06-1":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">ë¡œê³  êµì²´</h2>
              
              <div className="flex-1 flex flex-col items-center justify-center">
                {/* ë¡œê³  ë¯¸ë¦¬ë³´ê¸° */}
                <div className="mb-8 text-center">
                  <p className="text-sm text-muted-foreground mb-2">í˜„ì¬ ì ìš©ëœ ë¡œê³ </p>
                  <div className="w-40 h-40 bg-white border-2 border-dashed border-border rounded-xl flex items-center justify-center overflow-hidden relative">
                    {m06_1_logo ? (
                      <div className="relative w-full h-full flex items-center justify-center">
                        <span className="text-2xl font-bold text-primary">{m06_1_logo}</span>
                        <button 
                          onClick={() => setM06_1_logo(null)}
                          className="absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"
                        >
                          <X className="h-3 w-3" />
                        </button>
                      </div>
                    ) : (
                      <span className="text-muted-foreground text-sm">ë¡œê³  ì—†ìŒ</span>
                    )}
                  </div>
                </div>

                {/* ì—…ë¡œë“œ ì˜ì—­ */}
                <div className="w-full max-w-xs">
                  <label className="block text-sm font-medium text-foreground mb-2">ìƒˆ ë¡œê³  ì—…ë¡œë“œ</label>
                  <div className="flex gap-2">
                    <Input 
                      placeholder="íšŒì‚¬ëª… ì…ë ¥ (ì´ë¯¸ì§€ ëŒ€ì²´)" 
                      className="flex-1"
                      onChange={(e) => setM06_1_logo(e.target.value)}
                    />
                    <Button variant="outline">
                      <Upload className="h-4 w-4" />
                    </Button>
                  </div>
                  <p className="text-xs text-muted-foreground mt-2">
                    * ì‹¤ì œ êµ¬í˜„ ì‹œ ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì´ ì œê³µë©ë‹ˆë‹¤.
                  </p>
                </div>
              </div>
            </div>
          </Wrapper>
        )

      case "M06-2":
        const currentColor = themeColors.find(c => c.id === m06_2_color)?.color

        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6" style={{ 
              // @ts-ignore
              '--primary': currentColor 
            }}>
              <h2 className="text-xl font-bold text-foreground mb-6">ì»¬ëŸ¬ í…Œë§ˆ ì„¤ì •</h2>
              
              {/* í…Œë§ˆ ì„ íƒ */}
              <div className="grid grid-cols-2 gap-3 mb-8">
                {themeColors.map((theme) => (
                  <button
                    key={theme.id}
                    onClick={() => setM06_2_color(theme.id)}
                    className={`flex items-center gap-3 p-3 border-2 rounded-lg transition-all ${
                      m06_2_color === theme.id
                        ? 'border-primary bg-primary/5'
                        : 'border-border hover:border-primary/50'
                    }`}
                  >
                    <div 
                      className="w-6 h-6 rounded-full shadow-sm" 
                      style={{ backgroundColor: theme.color }}
                    />
                    <span className="text-sm font-medium">{theme.name}</span>
                  </button>
                ))}
              </div>

              {/* ë¯¸ë¦¬ë³´ê¸° ì»´í¬ë„ŒíŠ¸ë“¤ */}
              <div className="flex-1 space-y-6 p-6 bg-slate-50 rounded-xl border border-border">
                <h3 className="text-sm font-bold text-muted-foreground uppercase tracking-wider mb-4">Preview</h3>
                
                <Button className="w-full bg-[var(--primary)] hover:opacity-90 text-white">
                  Primary Button
                </Button>
                
                <div className="flex gap-2">
                  <Badge className="bg-[var(--primary)] text-white">Badge</Badge>
                  <Badge variant="outline" className="text-[var(--primary)] border-[var(--primary)]">Outline</Badge>
                </div>
                
                <div className="p-4 bg-white rounded-lg border-l-4 border-[var(--primary)] shadow-sm">
                  <p className="font-bold text-[var(--primary)]">ê°•ì¡° í…ìŠ¤íŠ¸</p>
                  <p className="text-sm text-slate-600">í…Œë§ˆ ìƒ‰ìƒì´ ì ìš©ëœ ì»´í¬ë„ŒíŠ¸ ì˜ˆì‹œì…ë‹ˆë‹¤.</p>
                </div>
              </div>
            </div>
          </Wrapper>
        )

      case "M06-3":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">í°íŠ¸ ì ìš©</h2>
              
              {/* í°íŠ¸ ì„ íƒ */}
              <div className="space-y-3 mb-8">
                {fontFamilies.map((font) => (
                  <div
                    key={font.id}
                    onClick={() => setM06_3_font(font.id)}
                    className={`p-4 border-2 rounded-xl cursor-pointer transition-all ${
                      m06_3_font === font.id
                        ? 'border-primary bg-primary/5'
                        : 'border-border hover:border-primary/50'
                    }`}
                  >
                    <div className="flex justify-between items-center mb-2">
                      <span className="font-bold text-sm">{font.name}</span>
                      {m06_3_font === font.id && <Check className="h-4 w-4 text-primary" />}
                    </div>
                    <p className={`text-lg ${font.class}`}>
                      ì•„ë¦„ë‹¤ìš´ ì£¼ê±° ê³µê°„, ë”ìƒµ
                    </p>
                  </div>
                ))}
              </div>

              {/* ë¯¸ë¦¬ë³´ê¸° í…ìŠ¤íŠ¸ */}
              <div className={`flex-1 p-6 bg-slate-50 rounded-xl border border-border ${
                fontFamilies.find(f => f.id === m06_3_font)?.class
              }`}>
                <h3 className="text-2xl font-bold mb-4">Sample Text</h3>
                <p className="leading-relaxed text-slate-700">
                  ëª¨ë“  ê²ƒì€ ë³€í•œë‹¤. í•˜ì§€ë§Œ ì›ì¹™ì€ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤. 
                  ìš°ë¦¬ëŠ” ê³µê°„ì˜ ê°€ì¹˜ë¥¼ ë„˜ì–´ ì‚¶ì˜ ê°€ì¹˜ë¥¼ ë§Œë“­ë‹ˆë‹¤.
                  The quick brown fox jumps over the lazy dog.
                  1234567890
                </p>
              </div>
            </div>
          </Wrapper>
        )

      case "M06-4":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6 bg-slate-100">
              <h2 className="text-xl font-bold text-foreground mb-6">íƒ€ì… ì •ë³´ í‘œì‹œ</h2>
              
              {/* ìœ„ì¹˜ ì„ íƒ */}
              <div className="flex gap-2 mb-6 bg-white p-1 rounded-lg border shadow-sm">
                {[
                  { id: 'top', name: 'ìƒë‹¨ ê³ ì •', icon: Layout },
                  { id: 'sidebar', name: 'ì‚¬ì´ë“œë°”', icon: Layout },
                  { id: 'none', name: 'í‘œì‹œ ì•ˆí•¨', icon: X }
                ].map((pos) => {
                  const Icon = pos.icon
                  return (
                    <button
                      key={pos.id}
                      onClick={() => setM06_4_typePos(pos.id)}
                      className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-all ${
                        m06_4_typePos === pos.id
                          ? 'bg-slate-900 text-white shadow-sm'
                          : 'text-slate-500 hover:bg-slate-50'
                      }`}
                    >
                      <Icon className="h-4 w-4" />
                      {pos.name}
                    </button>
                  )
                })}
              </div>

              {/* ë ˆì´ì•„ì›ƒ ì‹œë®¬ë ˆì´ì…˜ */}
              <div className="flex-1 bg-white border border-slate-300 rounded-xl overflow-hidden flex flex-col relative shadow-md">
                {/* ìƒë‹¨ë°” */}
                <div className="h-12 bg-slate-800 flex items-center justify-between px-4 text-white">
                  <span className="font-bold">LOGO</span>
                  {m06_4_typePos === 'top' && (
                    <div className="bg-white/20 px-3 py-1 rounded text-xs flex items-center gap-2 animate-in fade-in slide-in-from-top-2">
                      <span className="font-bold">84A Type</span>
                      <span className="w-px h-3 bg-white/30"/>
                      <span>101-1001</span>
                    </div>
                  )}
                  <div className="w-6 h-6 bg-white/20 rounded-full"/>
                </div>

                <div className="flex-1 flex">
                  {/* ì‚¬ì´ë“œë°” */}
                  {m06_4_typePos === 'sidebar' && (
                    <div className="w-32 bg-slate-50 border-r border-slate-200 p-4 animate-in slide-in-from-left-10">
                      <div className="mb-4 p-2 bg-white border rounded shadow-sm">
                        <p className="text-xs text-slate-500 mb-1">Contract Info</p>
                        <p className="font-bold text-slate-900">84A Type</p>
                        <p className="text-xs text-slate-700">101-1001</p>
                      </div>
                      <div className="space-y-2">
                        <div className="h-2 w-20 bg-slate-200 rounded"/>
                        <div className="h-2 w-16 bg-slate-200 rounded"/>
                        <div className="h-2 w-24 bg-slate-200 rounded"/>
                      </div>
                    </div>
                  )}
                  
                  {/* ë©”ì¸ ì»¨í…ì¸  */}
                  <div className="flex-1 p-6 bg-white relative">
                    <div className="h-32 bg-slate-100 rounded-lg mb-4 flex items-center justify-center text-slate-300">
                      Content Area
                    </div>
                    <div className="space-y-2">
                      <div className="h-4 w-3/4 bg-slate-100 rounded"/>
                      <div className="h-4 w-1/2 bg-slate-100 rounded"/>
                      <div className="h-4 w-full bg-slate-100 rounded"/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </Wrapper>
        )

      case "M06-5":
        return (
          <Wrapper>
            <div className="flex flex-col min-h-full p-6">
              <h2 className="text-xl font-bold text-foreground mb-6">ë²„íŠ¼ ë ˆì´ì•„ì›ƒ ì„¤ì •</h2>
              
              {/* ë ˆì´ì•„ì›ƒ ì„ íƒ */}
              <div className="grid grid-cols-1 gap-3 mb-8">
                {layoutOptions.map((layout) => (
                  <button
                    key={layout.id}
                    onClick={() => setM06_5_layout(layout.id)}
                    className={`p-4 border-2 rounded-xl text-left transition-all ${
                      m06_5_layout === layout.id
                        ? 'border-primary bg-primary/5'
                        : 'border-border hover:border-primary/50'
                    }`}
                  >
                    <div className="flex justify-between items-center mb-1">
                      <span className="font-bold">{layout.name}</span>
                      {m06_5_layout === layout.id && <Badge>Active</Badge>}
                    </div>
                    <p className="text-xs text-muted-foreground">{layout.description}</p>
                  </button>
                ))}
              </div>

              {/* ë¯¸ë¦¬ë³´ê¸° í™”ë©´ */}
              <div className="flex-1 bg-slate-100 border border-slate-200 rounded-xl relative overflow-hidden flex flex-col shadow-inner">
                <div className="flex-1 p-4">
                  <div className="h-full bg-white rounded-lg border border-slate-200 p-4">
                    <div className="h-4 w-1/3 bg-slate-100 rounded mb-2"/>
                    <div className="h-32 bg-slate-50 rounded mb-4"/>
                    <div className="h-4 w-2/3 bg-slate-100 rounded"/>
                  </div>
                </div>

                {/* ë²„íŠ¼ ì˜ì—­ ì‹œë®¬ë ˆì´ì…˜ */}
                {m06_5_layout === 'bottom-fixed' && (
                  <div className="p-4 bg-white border-t border-slate-200 flex gap-2 animate-in slide-in-from-bottom-2">
                    <button className="flex-1 h-10 border border-slate-300 rounded bg-white text-sm font-medium">ì´ì „</button>
                    <button className="flex-1 h-10 bg-slate-900 text-white rounded text-sm font-medium">ë‹¤ìŒ ë‹¨ê³„</button>
                  </div>
                )}

                {m06_5_layout === 'inline' && (
                  <div className="absolute bottom-8 left-0 right-0 px-8 flex justify-between animate-in fade-in">
                    <button className="px-6 h-10 border border-slate-300 rounded-full bg-white text-sm font-medium shadow-sm">â† Prev</button>
                    <button className="px-6 h-10 bg-slate-900 text-white rounded-full text-sm font-medium shadow-sm">Next â†’</button>
                  </div>
                )}

                {m06_5_layout === 'floating' && (
                  <button className="absolute bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center animate-in zoom-in spin-in-12">
                    <ArrowRight className="h-6 w-6" />
                  </button>
                )}
              </div>
            </div>
          </Wrapper>
        )

      case "M07-1":
        const sampleGuideSteps = [
          { id: 1, title: '1ë‹¨ê³„: ë¡œê·¸ì¸', image: 'guide-01.png', description: 'ë™í˜¸ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”' },
          { id: 2, title: '2ë‹¨ê³„: íƒ€ì… ì„ íƒ', image: 'guide-02.png', description: 'ì›í•˜ëŠ” íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”' },
          { id: 3, title: '3ë‹¨ê³„: ì˜µì…˜ ì„ íƒ', image: 'guide-03.png', description: 'ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”' },
          { id: 4, title: '4ë‹¨ê³„: ê²¬ì  í™•ì¸', image: 'guide-04.png', description: 'ìµœì¢… ê²¬ì ì„ í™•ì¸í•˜ì„¸ìš”' }
        ]

        return (
          <Wrapper>
            <div className="flex h-full">
              {/* ì¢Œì¸¡: ìŠ¤í… ëª©ë¡ */}
              <div className="w-64 border-r bg-muted/30 p-4 space-y-2">
                <h3 className="font-bold text-sm mb-4">ê°€ì´ë“œ ë‹¨ê³„</h3>
                {sampleGuideSteps.map((step, index) => (
                  <button
                    key={step.id}
                    onClick={() => setM07_1_currentStep(index)}
                    className={`w-full text-left p-3 rounded-lg transition-all ${
                      m07_1_currentStep === index
                        ? 'bg-primary text-primary-foreground shadow-sm'
                        : 'bg-white hover:bg-muted'
                    }`}
                  >
                    <div className="font-medium text-sm">{step.title}</div>
                  </button>
                ))}
              </div>

              {/* ìš°ì¸¡: ìŠ¤í… ìƒì„¸ */}
              <div className="flex-1 p-6 space-y-6">
                <div>
                  <Badge className="mb-2">Step {m07_1_currentStep + 1} / {sampleGuideSteps.length}</Badge>
                  <h2 className="text-xl font-bold text-foreground mb-2">
                    {sampleGuideSteps[m07_1_currentStep].title}
                  </h2>
                  <p className="text-sm text-muted-foreground">
                    {sampleGuideSteps[m07_1_currentStep].description}
                  </p>
                </div>

                {/* ì´ë¯¸ì§€ ì˜ì—­ */}
                <div className="w-full h-64 bg-slate-100 border-2 border-dashed border-slate-300 rounded-xl flex items-center justify-center">
                  <div className="text-center">
                    <Image className="h-12 w-12 text-slate-400 mx-auto mb-2" />
                    <p className="text-sm text-slate-500">ê°€ì´ë“œ ì´ë¯¸ì§€ ì˜ì—­</p>
                    <p className="text-xs text-slate-400 mt-1">400 x 300px</p>
                  </div>
                </div>

                <Button className="w-full gap-2">
                  <Upload className="h-4 w-4" />
                  ì´ë¯¸ì§€ ì—…ë¡œë“œ
                </Button>

                {/* ë„¤ë¹„ê²Œì´ì…˜ */}
                <div className="flex justify-between pt-4 border-t">
                  <Button
                    variant="outline"
                    onClick={() => setM07_1_currentStep(Math.max(0, m07_1_currentStep - 1))}
                    disabled={m07_1_currentStep === 0}
                  >
                    <ArrowLeft className="h-4 w-4 mr-2" />
                    ì´ì „ ìŠ¤í…
                  </Button>
                  <Button
                    onClick={() => setM07_1_currentStep(Math.min(sampleGuideSteps.length - 1, m07_1_currentStep + 1))}
                    disabled={m07_1_currentStep === sampleGuideSteps.length - 1}
                  >
                    ë‹¤ìŒ ìŠ¤í…
                    <ArrowRight className="h-4 w-4 ml-2" />
                  </Button>
                </div>

                <Button variant="default" className="w-full bg-primary">
                  <Save className="h-4 w-4 mr-2" />
                  ê°€ì´ë“œ ì €ì¥
                </Button>
              </div>
            </div>
          </Wrapper>
        )

      case "M07-2":
        const sampleVideos = [
          { id: 1, title: 'ì „ì²´ ì‚¬ìš© ê°€ì´ë“œ', duration: '05:30', url: 'video-full.mp4', uploadDate: '2024-01-15' },
          { id: 2, title: 'ì˜µì…˜ ì„ íƒ ë°©ë²•', duration: '02:15', url: 'video-option.mp4', uploadDate: '2024-01-16' },
          { id: 3, title: 'ê²¬ì ì„œ ë‹¤ìš´ë¡œë“œ', duration: '01:30', url: 'video-download.mp4', uploadDate: '2024-01-17' }
        ]

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6 space-y-6">
              <div>
                <h2 className="text-xl font-bold text-foreground mb-2">ì˜ìƒ ê°€ì´ë“œ ì œì‘</h2>
                <p className="text-sm text-muted-foreground">ì‚¬ìš©ìë¥¼ ìœ„í•œ ì˜ìƒ ê°€ì´ë“œë¥¼ ì—…ë¡œë“œí•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
              </div>

              {/* ì—…ë¡œë“œ ì˜ì—­ */}
              <div className="w-full h-48 bg-slate-50 border-2 border-dashed border-slate-300 rounded-xl flex flex-col items-center justify-center hover:bg-slate-100 transition-colors cursor-pointer">
                <Video className="h-12 w-12 text-slate-400 mb-3" />
                <p className="text-sm font-medium text-slate-600 mb-1">ë¹„ë””ì˜¤ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
                <p className="text-xs text-slate-400">MP4, MOV, AVI (ìµœëŒ€ 100MB)</p>
                <Button variant="outline" className="mt-4">
                  <Upload className="h-4 w-4 mr-2" />
                  íŒŒì¼ ì„ íƒ
                </Button>
              </div>

              {/* ì—…ë¡œë“œëœ ì˜ìƒ ëª©ë¡ */}
              <div className="flex-1 border rounded-lg overflow-hidden">
                <div className="bg-muted/30 px-4 py-2 border-b">
                  <h3 className="font-semibold text-sm">ì—…ë¡œë“œëœ ì˜ìƒ</h3>
                </div>
                <div className="divide-y">
                  {sampleVideos.map((video) => (
                    <div
                      key={video.id}
                      className={`p-4 flex items-center justify-between hover:bg-muted/30 transition-colors cursor-pointer ${
                        m07_2_selectedVideo?.id === video.id ? 'bg-primary/5 border-l-4 border-l-primary' : ''
                      }`}
                      onClick={() => setM07_2_selectedVideo(video)}
                    >
                      <div className="flex items-center gap-3">
                        <div className="w-12 h-12 bg-slate-200 rounded flex items-center justify-center">
                          <Video className="h-6 w-6 text-slate-500" />
                        </div>
                        <div>
                          <p className="font-medium text-sm">{video.title}</p>
                          <div className="flex gap-3 text-xs text-muted-foreground mt-1">
                            <span className="flex items-center gap-1">
                              <Clock className="h-3 w-3" />
                              {video.duration}
                            </span>
                            <span>{video.uploadDate}</span>
                          </div>
                        </div>
                      </div>
                      <div className="flex gap-2">
                        <Button variant="outline" size="sm">ë¯¸ë¦¬ë³´ê¸°</Button>
                        <Button variant="destructive" size="sm">ì‚­ì œ</Button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* ì„ íƒëœ ì˜ìƒ í”„ë¦¬ë·° */}
              {m07_2_selectedVideo && (
                <Card>
                  <CardContent className="p-4">
                    <div className="aspect-video bg-slate-900 rounded-lg flex items-center justify-center">
                      <div className="text-center text-white">
                        <Video className="h-16 w-16 mx-auto mb-2 opacity-50" />
                        <p className="text-sm">ì˜ìƒ í”Œë ˆì´ì–´</p>
                        <p className="text-xs opacity-70 mt-1">{m07_2_selectedVideo.title}</p>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              )}
            </div>
          </Wrapper>
        )

      case "M07-3":
        const popupPages = [
          {
            title: 'í™˜ì˜í•©ë‹ˆë‹¤!',
            content: 'ì˜µì…˜ ì„ íƒ ì‹œìŠ¤í…œ ì‚¬ìš©ë²•ì„ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤.',
            icon: 'Sparkles'
          },
          {
            title: 'íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”',
            content: 'ë¨¼ì € ì›í•˜ëŠ” íƒ€ì…(í‰í˜•)ì„ ì„ íƒí•©ë‹ˆë‹¤.',
            icon: 'Home'
          },
          {
            title: 'ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”',
            content: 'ê° ê³µê°„ë³„ ì˜µì…˜ì„ ììœ ë¡­ê²Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
            icon: 'Check'
          },
          {
            title: 'ê²¬ì ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”',
            content: 'ìµœì¢… ê²¬ì ì„œë¥¼ í™•ì¸í•˜ê³  ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
            icon: 'FileText'
          }
        ]

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6">
              <div className="mb-6">
                <h2 className="text-xl font-bold text-foreground mb-2">ê°€ì´ë“œ íŒì—…</h2>
                <p className="text-sm text-muted-foreground">ìµœì´ˆ ì ‘ì† ì‹œ í‘œì‹œë˜ëŠ” ì‚¬ìš© ê°€ì´ë“œ íŒì—…ì„ ì„¤ì •í•©ë‹ˆë‹¤.</p>
              </div>

              <div className="flex-1 flex items-center justify-center">
                <Button
                  size="lg"
                  onClick={() => setM07_3_showPopup(true)}
                  className="gap-2"
                >
                  <HelpCircle className="h-5 w-5" />
                  ê°€ì´ë“œ íŒì—… ë¯¸ë¦¬ë³´ê¸°
                </Button>
              </div>

              {/* ê°€ì´ë“œ íŒì—… ëª¨ë‹¬ */}
              {m07_3_showPopup && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-in fade-in">
                  <Card className="w-full max-w-md mx-4 shadow-2xl animate-in zoom-in-95">
                    <CardHeader className="relative pb-2">
                      <button
                        onClick={() => setM07_3_showPopup(false)}
                        className="absolute right-4 top-4 text-muted-foreground hover:text-foreground"
                      >
                        âœ•
                      </button>
                      <div className="text-center">
                        <Badge variant="secondary" className="mb-2">
                          {m07_3_currentPage + 1} / {popupPages.length}
                        </Badge>
                        <div className="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
                          {m07_3_currentPage === 0 && <HelpCircle className="h-8 w-8 text-primary" />}
                          {m07_3_currentPage === 1 && <Home className="h-8 w-8 text-primary" />}
                          {m07_3_currentPage === 2 && <Check className="h-8 w-8 text-primary" />}
                          {m07_3_currentPage === 3 && <FileText className="h-8 w-8 text-primary" />}
                        </div>
                        <CardTitle className="text-lg">{popupPages[m07_3_currentPage].title}</CardTitle>
                      </div>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <p className="text-center text-muted-foreground">
                        {popupPages[m07_3_currentPage].content}
                      </p>

                      <div className="flex items-center justify-center gap-2 py-2">
                        {popupPages.map((_, index) => (
                          <div
                            key={index}
                            className={`h-2 rounded-full transition-all ${
                              index === m07_3_currentPage ? 'w-8 bg-primary' : 'w-2 bg-muted'
                            }`}
                          />
                        ))}
                      </div>

                      <div className="flex items-center gap-2 text-sm">
                        <Checkbox
                          checked={m07_3_dontShowAgain}
                          onCheckedChange={(checked) => setM07_3_dontShowAgain(checked as boolean)}
                        />
                        <label className="text-muted-foreground">ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°</label>
                      </div>

                      <div className="flex gap-2">
                        {m07_3_currentPage > 0 && (
                          <Button
                            variant="outline"
                            className="flex-1"
                            onClick={() => setM07_3_currentPage(m07_3_currentPage - 1)}
                          >
                            ì´ì „
                          </Button>
                        )}
                        <Button
                          className="flex-1"
                          onClick={() => {
                            if (m07_3_currentPage < popupPages.length - 1) {
                              setM07_3_currentPage(m07_3_currentPage + 1)
                            } else {
                              setM07_3_showPopup(false)
                              setM07_3_currentPage(0)
                            }
                          }}
                        >
                          {m07_3_currentPage < popupPages.length - 1 ? 'ë‹¤ìŒ' : 'ì‹œì‘í•˜ê¸°'}
                        </Button>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              )}
            </div>
          </Wrapper>
        )

      case "M07-4":
        const guideMenu = [
          { id: 'quick-start', name: 'ë¹ ë¥¸ ì‹œì‘', icon: AlertCircle },
          { id: 'option-guide', name: 'ì˜µì…˜ ì„ íƒ ê°€ì´ë“œ', icon: Check },
          { id: 'quote-guide', name: 'ê²¬ì ì„œ ê°€ì´ë“œ', icon: FileText },
          { id: 'faq', name: 'ìì£¼ ë¬»ëŠ” ì§ˆë¬¸', icon: HelpCircle },
          { id: 'video', name: 'ì˜ìƒ ê°€ì´ë“œ', icon: Video }
        ]

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6">
              <div className="mb-6">
                <h2 className="text-xl font-bold text-foreground mb-2">ê°€ì´ë“œ ë²„íŠ¼</h2>
                <p className="text-sm text-muted-foreground">ì‚¬ìš©ìê°€ ì–¸ì œë“  ê°€ì´ë“œë¥¼ ë³¼ ìˆ˜ ìˆë„ë¡ ë²„íŠ¼ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
              </div>

              <div className="flex-1 bg-slate-100 rounded-xl relative overflow-hidden border-2">
                {/* ë©”ì¸ ì½˜í…ì¸  ì‹œë®¬ë ˆì´ì…˜ */}
                <div className="p-8">
                  <div className="bg-white rounded-lg p-6 shadow-sm">
                    <div className="h-4 w-1/3 bg-slate-200 rounded mb-4" />
                    <div className="h-32 bg-slate-100 rounded mb-4" />
                    <div className="h-4 w-2/3 bg-slate-200 rounded" />
                  </div>
                </div>

                {/* ìš°ì¸¡ í•˜ë‹¨ í”Œë¡œíŒ… ë²„íŠ¼ */}
                <button
                  onClick={() => setM07_4_showGuide(!m07_4_showGuide)}
                  className="fixed bottom-8 right-8 w-14 h-14 bg-primary text-primary-foreground rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-transform z-10"
                >
                  <HelpCircle className="h-6 w-6" />
                </button>

                {/* ê°€ì´ë“œ ë©”ë‰´ íŒ¨ë„ */}
                {m07_4_showGuide && (
                  <div className="fixed bottom-24 right-8 w-72 bg-white rounded-lg shadow-2xl border-2 animate-in slide-in-from-bottom-4 z-10">
                    <div className="p-4 border-b">
                      <div className="flex items-center justify-between">
                        <h3 className="font-bold text-sm">ë„ì›€ë§</h3>
                        <button
                          onClick={() => setM07_4_showGuide(false)}
                          className="text-muted-foreground hover:text-foreground"
                        >
                          âœ•
                        </button>
                      </div>
                    </div>
                    <div className="p-2">
                      {guideMenu.map((item) => {
                        const Icon = item.icon
                        return (
                          <button
                            key={item.id}
                            onClick={() => {
                              setM07_4_selectedGuide(item.id)
                              setTimeout(() => setM07_4_showGuide(false), 500)
                            }}
                            className={`w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors ${
                              m07_4_selectedGuide === item.id
                                ? 'bg-primary/10 text-primary'
                                : 'hover:bg-muted'
                            }`}
                          >
                            <Icon className="h-5 w-5" />
                            <span className="text-sm font-medium">{item.name}</span>
                          </button>
                        )
                      })}
                    </div>
                  </div>
                )}

                {/* ì„ íƒëœ ê°€ì´ë“œ ë‚´ìš© */}
                {m07_4_selectedGuide && (
                  <div className="absolute top-4 left-4 right-4 bg-white rounded-lg shadow-lg border-2 border-primary p-4 animate-in slide-in-from-top-2">
                    <div className="flex items-start justify-between mb-2">
                      <Badge variant="default">
                        {guideMenu.find(g => g.id === m07_4_selectedGuide)?.name}
                      </Badge>
                      <button
                        onClick={() => setM07_4_selectedGuide('')}
                        className="text-muted-foreground hover:text-foreground"
                      >
                        âœ•
                      </button>
                    </div>
                    <p className="text-sm text-muted-foreground">
                      ì„ íƒí•œ ê°€ì´ë“œì˜ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                  </div>
                )}
              </div>
            </div>
          </Wrapper>
        )

      case "M08-1":
        const recentSubmissions = [
          { id: 'Q247', name: 'ê¹€ì² ìˆ˜', type: '84A', amount: 15800000, date: '2024-01-17 14:30', status: 'ì™„ë£Œ' },
          { id: 'Q246', name: 'ì´ì˜í¬', type: '84B', amount: 16200000, date: '2024-01-17 11:20', status: 'ì™„ë£Œ' },
          { id: 'Q245', name: 'ë°•ë¯¼ìˆ˜', type: '59A', amount: 12500000, date: '2024-01-17 09:15', status: 'ì™„ë£Œ' },
          { id: 'Q244', name: 'ìµœì§€ì€', type: '84A', amount: 17100000, date: '2024-01-16 16:45', status: 'ì™„ë£Œ' },
          { id: 'Q243', name: 'ì •ìš°ì§„', type: '84B', amount: 15900000, date: '2024-01-16 14:10', status: 'ì™„ë£Œ' }
        ]

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6 space-y-6">
              <div>
                <h2 className="text-xl font-bold text-foreground mb-2">ê´€ë¦¬ì í˜ì´ì§€</h2>
                <p className="text-sm text-muted-foreground">ì‹œìŠ¤í…œ í†µê³„ ë° ì œì¶œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
              </div>

              {/* í†µê³„ ì¹´ë“œ */}
              <div className="grid grid-cols-4 gap-4">
                <Card>
                  <CardContent className="p-4">
                    <p className="text-xs text-muted-foreground mb-1">ì´ ì œì¶œ ê±´ìˆ˜</p>
                    <p className="text-2xl font-bold text-primary">{m08_1_stats.totalSubmissions}ê±´</p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <p className="text-xs text-muted-foreground mb-1">ì˜¤ëŠ˜ ì œì¶œ</p>
                    <p className="text-2xl font-bold text-green-600">{m08_1_stats.todaySubmissions}ê±´</p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <p className="text-xs text-muted-foreground mb-1">í‰ê·  ê²¬ì  ê¸ˆì•¡</p>
                    <p className="text-2xl font-bold text-foreground">
                      {(m08_1_stats.averageAmount / 10000).toFixed(0)}ë§Œì›
                    </p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <p className="text-xs text-muted-foreground mb-1">ì¸ê¸° ì˜µì…˜</p>
                    <p className="text-lg font-bold text-foreground">{m08_1_stats.topOption}</p>
                  </CardContent>
                </Card>
              </div>

              {/* ìµœê·¼ ì œì¶œ ëª©ë¡ */}
              <Card className="flex-1">
                <CardHeader>
                  <CardTitle className="text-base">ìµœê·¼ ì œì¶œ ë‚´ì—­</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="border rounded-lg overflow-hidden">
                    <table className="w-full text-sm">
                      <thead className="bg-muted/50">
                        <tr>
                          <th className="text-left p-3 font-semibold">ê²¬ì  ID</th>
                          <th className="text-left p-3 font-semibold">ê³ ê°ëª…</th>
                          <th className="text-left p-3 font-semibold">íƒ€ì…</th>
                          <th className="text-right p-3 font-semibold">ê¸ˆì•¡</th>
                          <th className="text-left p-3 font-semibold">ì œì¶œ ì‹œê°</th>
                          <th className="text-center p-3 font-semibold">ìƒíƒœ</th>
                          <th className="text-center p-3 font-semibold">ì•¡ì…˜</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y">
                        {recentSubmissions.map((item) => (
                          <tr key={item.id} className="hover:bg-muted/30">
                            <td className="p-3 font-medium">{item.id}</td>
                            <td className="p-3">{item.name}</td>
                            <td className="p-3">
                              <Badge variant="outline">{item.type}</Badge>
                            </td>
                            <td className="p-3 text-right font-medium">
                              {item.amount.toLocaleString()}ì›
                            </td>
                            <td className="p-3 text-muted-foreground">{item.date}</td>
                            <td className="p-3 text-center">
                              <Badge variant="secondary">{item.status}</Badge>
                            </td>
                            <td className="p-3 text-center">
                              <Button variant="ghost" size="sm">ìƒì„¸ë³´ê¸°</Button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </CardContent>
              </Card>

              {/* ë¹ ë¥¸ ì•¡ì…˜ */}
              <div className="flex gap-3">
                <Button variant="outline" className="flex-1 gap-2">
                  <Download className="h-4 w-4" />
                  ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                </Button>
                <Button variant="outline" className="flex-1 gap-2">
                  <UserCog className="h-4 w-4" />
                  ì˜µì…˜ ì„¤ì •
                </Button>
                <Button variant="outline" className="flex-1 gap-2">
                  <UserCog className="h-4 w-4" />
                  ì‚¬ìš©ì ê´€ë¦¬
                </Button>
              </div>
            </div>
          </Wrapper>
        )

      case "M08-2":
        const sampleSearchResults = [
          { id: 'Q001', name: 'ê¹€ì² ìˆ˜', type: '84A', amount: 15800000, date: '2024-01-15', status: 'ì™„ë£Œ' },
          { id: 'Q002', name: 'ì´ì˜í¬', type: '84B', amount: 16200000, date: '2024-01-16', status: 'ì™„ë£Œ' },
          { id: 'Q003', name: 'ë°•ë¯¼ìˆ˜', type: '59A', amount: 12500000, date: '2024-01-17', status: 'ì™„ë£Œ' }
        ]

        const handleSearch = () => {
          if (m08_2_searchTerm) {
            setM08_2_searchResults(sampleSearchResults.filter(
              item => item.name.includes(m08_2_searchTerm) || item.id.includes(m08_2_searchTerm)
            ))
          } else {
            setM08_2_searchResults(sampleSearchResults)
          }
        }

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6 space-y-6">
              <div>
                <h2 className="text-xl font-bold text-foreground mb-2">ë°ì´í„° ê²€ìƒ‰ ê¸°ëŠ¥</h2>
                <p className="text-sm text-muted-foreground">ì œì¶œëœ ê²¬ì  ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  í•„í„°ë§í•©ë‹ˆë‹¤.</p>
              </div>

              {/* ê²€ìƒ‰ ì˜ì—­ */}
              <Card>
                <CardHeader>
                  <CardTitle className="text-base">ê²€ìƒ‰ ì¡°ê±´</CardTitle>
                </CardHeader>
                <CardContent className="space-y-4">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="text-sm font-medium mb-2 block">ê²€ìƒ‰ì–´</label>
                      <div className="flex gap-2">
                        <Input
                          placeholder="ì´ë¦„, ë™í˜¸ìˆ˜, ê²¬ì  ID"
                          value={m08_2_searchTerm}
                          onChange={(e) => setM08_2_searchTerm(e.target.value)}
                        />
                        <Button onClick={handleSearch}>
                          <Search className="h-4 w-4" />
                        </Button>
                      </div>
                    </div>
                    <div>
                      <label className="text-sm font-medium mb-2 block">íƒ€ì… í•„í„°</label>
                      <select
                        className="w-full h-10 px-3 rounded-md border border-input bg-background"
                        value={m08_2_filterType}
                        onChange={(e) => setM08_2_filterType(e.target.value)}
                      >
                        <option value="all">ì „ì²´</option>
                        <option value="84A">84A</option>
                        <option value="84B">84B</option>
                        <option value="59A">59A</option>
                      </select>
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="text-sm font-medium mb-2 block">ì‹œì‘ì¼</label>
                      <Input type="date" />
                    </div>
                    <div>
                      <label className="text-sm font-medium mb-2 block">ì¢…ë£Œì¼</label>
                      <Input type="date" />
                    </div>
                  </div>

                  <div className="flex gap-2">
                    <Button onClick={handleSearch} className="flex-1">
                      <Search className="h-4 w-4 mr-2" />
                      ê²€ìƒ‰
                    </Button>
                    <Button
                      variant="outline"
                      onClick={() => {
                        setM08_2_searchTerm('')
                        setM08_2_filterType('all')
                        setM08_2_searchResults([])
                      }}
                    >
                      ì´ˆê¸°í™”
                    </Button>
                  </div>
                </CardContent>
              </Card>

              {/* ê²€ìƒ‰ ê²°ê³¼ */}
              <Card className="flex-1">
                <CardHeader>
                  <div className="flex items-center justify-between">
                    <CardTitle className="text-base">
                      ê²€ìƒ‰ ê²°ê³¼ {m08_2_searchResults.length > 0 && `(${m08_2_searchResults.length}ê±´)`}
                    </CardTitle>
                    {m08_2_searchResults.length > 0 && (
                      <Button size="sm" variant="outline" className="gap-2">
                        <Download className="h-3 w-3" />
                        Excel ë‹¤ìš´ë¡œë“œ
                      </Button>
                    )}
                  </div>
                </CardHeader>
                <CardContent>
                  {m08_2_searchResults.length > 0 ? (
                    <div className="border rounded-lg overflow-hidden">
                      <table className="w-full text-sm">
                        <thead className="bg-muted/50">
                          <tr>
                            <th className="text-left p-3 font-semibold">ê²¬ì  ID</th>
                            <th className="text-left p-3 font-semibold">ê³ ê°ëª…</th>
                            <th className="text-left p-3 font-semibold">íƒ€ì…</th>
                            <th className="text-right p-3 font-semibold">ê¸ˆì•¡</th>
                            <th className="text-left p-3 font-semibold">ë‚ ì§œ</th>
                            <th className="text-center p-3 font-semibold">ì•¡ì…˜</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y">
                          {m08_2_searchResults.map((item) => (
                            <tr key={item.id} className="hover:bg-muted/30">
                              <td className="p-3 font-medium">{item.id}</td>
                              <td className="p-3">{item.name}</td>
                              <td className="p-3">
                                <Badge variant="outline">{item.type}</Badge>
                              </td>
                              <td className="p-3 text-right font-medium">
                                {item.amount.toLocaleString()}ì›
                              </td>
                              <td className="p-3 text-muted-foreground">{item.date}</td>
                              <td className="p-3 text-center">
                                <Button variant="ghost" size="sm">ìƒì„¸ë³´ê¸°</Button>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  ) : (
                    <div className="text-center py-12 text-muted-foreground">
                      <Search className="h-12 w-12 mx-auto mb-3 opacity-50" />
                      <p className="text-sm">ê²€ìƒ‰ ì¡°ê±´ì„ ì…ë ¥í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                    </div>
                  )}
                </CardContent>
              </Card>
            </div>
          </Wrapper>
        )

      case "M08-3":
        const handleExport = () => {
          setM08_3_isExporting(true)
          setM08_3_exportProgress(0)

          const interval = setInterval(() => {
            setM08_3_exportProgress((prev) => {
              if (prev >= 100) {
                clearInterval(interval)
                setTimeout(() => {
                  setM08_3_isExporting(false)
                  setM08_3_exportProgress(0)
                  alert('Excel íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!')
                }, 500)
                return 100
              }
              return prev + 10
            })
          }, 200)
        }

        return (
          <Wrapper>
            <div className="flex flex-col h-full p-6 space-y-6">
              <div>
                <h2 className="text-xl font-bold text-foreground mb-2">Excel ì¼ê´„ ë‹¤ìš´ë¡œë“œ</h2>
                <p className="text-sm text-muted-foreground">ì „ì²´ ê²¬ì  ë°ì´í„°ë¥¼ Excel íŒŒì¼ë¡œ ì¼ê´„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.</p>
              </div>

              <div className="grid grid-cols-2 gap-6">
                {/* ë‹¤ìš´ë¡œë“œ ì„¤ì • */}
                <Card>
                  <CardHeader>
                    <CardTitle className="text-base">ë‹¤ìš´ë¡œë“œ ì„¤ì •</CardTitle>
                  </CardHeader>
                  <CardContent className="space-y-4">
                    <div className="flex items-center gap-3">
                      <Checkbox
                        checked={m08_3_includeOptions}
                        onCheckedChange={(checked) => setM08_3_includeOptions(checked as boolean)}
                      />
                      <label className="text-sm">ì˜µì…˜ ìƒì„¸ í¬í•¨</label>
                    </div>
                    <div className="flex items-center gap-3">
                      <Checkbox
                        checked={m08_3_includeCustomerInfo}
                        onCheckedChange={(checked) => setM08_3_includeCustomerInfo(checked as boolean)}
                      />
                      <label className="text-sm">ê³ ê° ì •ë³´ í¬í•¨</label>
                    </div>
                    <div className="flex items-center gap-3">
                      <Checkbox checked={true} />
                      <label className="text-sm">ì œì¶œ ì‹œê° í¬í•¨</label>
                    </div>

                    <div className="pt-4 border-t">
                      <label className="text-sm font-medium mb-2 block">ë‚ ì§œ ë²”ìœ„</label>
                      <div className="space-y-2">
                        <Input type="date" placeholder="ì‹œì‘ì¼" />
                        <Input type="date" placeholder="ì¢…ë£Œì¼" />
                      </div>
                    </div>
                  </CardContent>
                </Card>

                {/* ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° */}
                <Card>
                  <CardHeader>
                    <CardTitle className="text-base">ë°ì´í„° ì •ë³´</CardTitle>
                  </CardHeader>
                  <CardContent className="space-y-6">
                    <div className="space-y-3">
                      <div className="flex justify-between text-sm">
                        <span className="text-muted-foreground">ì´ ë°ì´í„° ê±´ìˆ˜</span>
                        <span className="font-bold">247ê±´</span>
                      </div>
                      <div className="flex justify-between text-sm">
                        <span className="text-muted-foreground">ì˜ˆìƒ íŒŒì¼ í¬ê¸°</span>
                        <span className="font-bold">1.2 MB</span>
                      </div>
                      <div className="flex justify-between text-sm">
                        <span className="text-muted-foreground">ì˜ˆìƒ ë‹¤ìš´ë¡œë“œ ì‹œê°„</span>
                        <span className="font-bold">ì•½ 3ì´ˆ</span>
                      </div>
                    </div>

                    <div className="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                      <div className="flex items-start gap-2">
                        <AlertCircle className="h-4 w-4 text-blue-600 mt-0.5" />
                        <div className="text-xs text-blue-800">
                          <p className="font-semibold mb-1">ë‹¤ìš´ë¡œë“œ ì•ˆë‚´</p>
                          <p>íŒŒì¼ëª…: quotes_20240117.xlsx</p>
                          <p>í˜•ì‹: Microsoft Excel (.xlsx)</p>
                        </div>
                      </div>
                    </div>

                    <Button
                      className="w-full gap-2"
                      size="lg"
                      onClick={handleExport}
                      disabled={m08_3_isExporting}
                    >
                      {m08_3_isExporting ? (
                        <>
                          <RefreshCw className="h-4 w-4 animate-spin" />
                          ë‹¤ìš´ë¡œë“œ ì¤‘... {m08_3_exportProgress}%
                        </>
                      ) : (
                        <>
                          <Download className="h-4 w-4" />
                          Excel ë‹¤ìš´ë¡œë“œ
                        </>
                      )}
                    </Button>

                    {m08_3_isExporting && (
                      <div className="space-y-2">
                        <div className="w-full bg-slate-200 rounded-full h-2 overflow-hidden">
                          <div
                            className="bg-primary h-full transition-all duration-300"
                            style={{ width: `${m08_3_exportProgress}%` }}
                          />
                        </div>
                        <p className="text-xs text-center text-muted-foreground">
                          ë°ì´í„° ì¤€ë¹„ ì¤‘...
                        </p>
                      </div>
                    )}
                  </CardContent>
                </Card>
              </div>

              {/* ë‹¤ìš´ë¡œë“œ ì´ë ¥ */}
              <Card>
                <CardHeader>
                  <CardTitle className="text-base">ìµœê·¼ ë‹¤ìš´ë¡œë“œ ì´ë ¥</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    {[
                      { date: '2024-01-17 14:30', file: 'quotes_20240117.xlsx', size: '1.2 MB' },
                      { date: '2024-01-16 09:15', file: 'quotes_20240116.xlsx', size: '1.1 MB' },
                      { date: '2024-01-15 16:45', file: 'quotes_20240115.xlsx', size: '980 KB' }
                    ].map((item, index) => (
                      <div
                        key={index}
                        className="flex items-center justify-between p-3 border rounded-lg hover:bg-muted/30"
                      >
                        <div className="flex items-center gap-3">
                          <FileText className="h-5 w-5 text-green-600" />
                          <div>
                            <p className="text-sm font-medium">{item.file}</p>
                            <p className="text-xs text-muted-foreground">{item.date}</p>
                          </div>
                        </div>
                        <div className="flex items-center gap-3">
                          <Badge variant="outline">{item.size}</Badge>
                          <Button variant="ghost" size="sm">ì¬ë‹¤ìš´ë¡œë“œ</Button>
                        </div>
                      </div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            </div>
          </Wrapper>
        )

      default:
        const module = Object.values(allModules)
          .flat()
          .find((m) => m.id === moduleId);

        return (
          <Wrapper>
            <div className="flex items-center justify-center h-full p-8">
              <div className="text-center max-w-md">
                <div className="w-24 h-24 bg-muted rounded-xl mx-auto mb-6 flex items-center justify-center">
                  <Monitor className="h-12 w-12 text-muted-foreground" />
                </div>
                <p className="text-lg font-semibold text-foreground mb-2">
                  {module?.name || moduleId}
                </p>
                <Badge variant="outline" className="mb-4">
                  {moduleId}
                </Badge>
                <p className="text-sm text-muted-foreground mb-4">
                  ì´ ëª¨ë“ˆì˜ í”„ë¡œí† íƒ€ì…ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤.
                </p>
                <div className="p-3 bg-blue-50 border border-blue-200 rounded-lg text-xs text-blue-800">
                  <p className="font-semibold mb-1">ğŸ“‹ êµ¬í˜„ ì˜ˆì • (Phase 2-5)</p>
                  <p>SYSTEM_FLOW.mdë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬í˜„ë©ë‹ˆë‹¤.</p>
                </div>
              </div>
            </div>
          </Wrapper>
        );
    }
  };

  const currentConditions = getConditionsForModule(selectedModule);

  return (
    <div className="relative w-full h-[calc(100vh-300px)] min-h-[600px] border rounded-xl shadow-sm overflow-hidden bg-background flex flex-col">
      <div className="flex flex-1 overflow-hidden h-full">
        {/* LEFT SIDEBAR */}
        <div className="w-[300px] flex-none border-r bg-background overflow-y-auto z-10 shadow-md">
          <div className="p-4 space-y-4">
            <h2 className="text-lg font-bold px-2">ëª¨ë“ˆ ì„ íƒ</h2>
            {Object.entries(modulesByCategory).map(([category, modules]) => {
              const isExpanded = expandedCategories.has(category);
              return (
                <div
                  key={category}
                  className="border rounded-lg overflow-hidden"
                >
                  <button
                    onClick={() => toggleCategory(category)}
                    className="w-full flex items-center justify-between p-3 bg-muted/30 hover:bg-muted/50 transition-colors text-left"
                  >
                    <span className="text-sm font-semibold text-foreground">
                      {category}
                    </span>
                    <ChevronRight
                      className={`h-4 w-4 text-muted-foreground transition-transform ${
                        isExpanded ? "rotate-90" : ""
                      }`}
                    />
                  </button>

                  {isExpanded && (
                    <div className="p-2 space-y-1 bg-white">
                      {modules.map((module) => (
                        <button
                          key={module.id}
                          onClick={() => setSelectedModule(module.id)}
                          className={`w-full text-left px-3 py-2 rounded-md text-xs transition-all ${
                            selectedModule === module.id
                              ? "bg-primary text-primary-foreground font-medium shadow-sm"
                              : "hover:bg-muted text-foreground"
                          }`}
                        >
                          <span className="font-bold mr-2">{module.id}</span>
                          {module.name}
                        </button>
                      ))}
                    </div>
                  )}
                </div>
              );
            })}
          </div>
        </div>

        {/* RIGHT PREVIEW AREA */}
        <div className="flex-1 flex flex-col h-full overflow-hidden bg-slate-50">
          {/* Top Controls Bar */}
          <div className="flex-none p-4 space-y-4 bg-white border-b shadow-sm z-10">
            {/* Device View Toggle */}
            <div className="flex items-center justify-between">
              <h3 className="text-sm font-bold text-foreground">
                ë””ë°”ì´ìŠ¤ ì„¤ì •
              </h3>
              <div className="flex bg-muted p-1 rounded-lg">
                {[
                  { value: "desktop", icon: Monitor, label: "PC" },
                  { value: "tablet", icon: Tablet, label: "Tablet" },
                  { value: "mobile", icon: Smartphone, label: "Mobile" },
                ].map((device) => {
                  const Icon = device.icon;
                  const isActive = deviceView === device.value;
                  return (
                    <button
                      key={device.value}
                      onClick={() => setDeviceView(device.value as any)}
                      className={`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-medium transition-all ${
                        isActive
                          ? "bg-white text-primary shadow-sm"
                          : "text-muted-foreground hover:text-foreground"
                      }`}
                    >
                      <Icon className="h-3.5 w-3.5" />
                      {device.label}
                    </button>
                  );
                })}
              </div>
            </div>

            {/* Condition Controls */}
            {currentConditions.length > 0 && (
              <div className="pt-2 border-t">
                <h3 className="text-sm font-bold text-foreground mb-3">
                  ì¡°ê±´ ì‹œë®¬ë ˆì´ì…˜
                </h3>
                <div className="flex flex-wrap gap-4">
                  {currentConditions.map((condition) => (
                    <div
                      key={condition.id}
                      className="flex items-center gap-3 bg-muted/30 px-3 py-1.5 rounded-lg border"
                    >
                      <span className="text-xs font-medium text-muted-foreground">
                        {condition.label}
                      </span>

                      {condition.type === "toggle" ? (
                        <div className="flex gap-1">
                          {["Y", "N"].map((option) => {
                            const isActive =
                              conditions[condition.id] === (option === "Y");
                            return (
                              <button
                                key={option}
                                onClick={() =>
                                  setConditions((prev) => ({
                                    ...prev,
                                    [condition.id]: option === "Y",
                                  }))
                                }
                                className={`w-6 h-6 flex items-center justify-center rounded-md text-[10px] font-bold transition-all ${
                                  isActive
                                    ? "bg-primary text-white"
                                    : "bg-white border text-muted-foreground hover:bg-slate-50"
                                }`}
                              >
                                {option}
                              </button>
                            );
                          })}
                        </div>
                      ) : (
                        <div className="flex gap-1">
                          {condition.options?.map((option) => {
                            const isActive =
                              conditions[condition.id] === option;
                            return (
                              <button
                                key={option}
                                onClick={() =>
                                  setConditions((prev) => ({
                                    ...prev,
                                    [condition.id]: option,
                                  }))
                                }
                                className={`px-2 h-6 flex items-center justify-center rounded-md text-[10px] font-bold transition-all ${
                                  isActive
                                    ? "bg-primary text-white"
                                    : "bg-white border text-muted-foreground hover:bg-slate-50"
                                }`}
                              >
                                {option}
                              </button>
                            );
                          })}
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>

          {/* Preview Content Area */}
          <div className="flex-1 overflow-hidden relative">
            <div className="absolute inset-0 overflow-auto">
              {getPreviewContent(selectedModule)}
            </div>
          </div>
        </div>
      </div>

      {/* Bottom Action Bar */}
      <div className="absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md border-t shadow-lg z-50">
        <div className="container mx-auto px-8 py-4 flex items-center justify-between">
          <Button
            variant="outline"
            size="lg"
            onClick={onNavigateToModules}
            className="gap-2 border-2 bg-transparent"
          >
            <ChevronLeft className="h-5 w-5" />
            ì´ì „
          </Button>

          <div className="flex items-center gap-3">
            <Badge variant="outline" className="px-4 py-2 text-sm bg-white">
              {selectedModule}
            </Badge>
            <span className="text-sm text-muted-foreground hidden sm:inline-block">
              {(() => {
                // 1. ì¹´í…Œê³ ë¦¬ í‚¤ë¥¼ ì°¾ìŠµë‹ˆë‹¤.
                const categoryKey = Object.keys(modulesByCategory).find((cat) =>
                  modulesByCategory[cat as keyof typeof modulesByCategory].some(
                    (m) => m.id === selectedModule
                  )
                ) as keyof typeof modulesByCategory; // ì—¬ê¸°ì„œ íƒ€ì…ì„ í™•ì • ì§“ìŠµë‹ˆë‹¤.

                // 2. ì°¾ì€ í‚¤ë¡œ ì•ˆì „í•˜ê²Œ ì ‘ê·¼í•˜ì—¬ ì´ë¦„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
                return categoryKey
                  ? modulesByCategory[categoryKey]?.find(
                      (m) => m.id === selectedModule
                    )?.name
                  : "";
              })()}
            </span>
          </div>

          <Button
            variant="default"
            size="lg"
            className="gap-2 bg-slate-900 text-white hover:bg-slate-800"
          >
            <Download className="h-5 w-5" />
            ì½”ë“œ ë‚´ë³´ë‚´ê¸°
          </Button>
        </div>
      </div>
    </div>
  );
}
